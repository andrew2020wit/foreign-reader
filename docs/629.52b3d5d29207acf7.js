"use strict";(self.webpackChunkforeign_reader=self.webpackChunkforeign_reader||[]).push([[629],{3631:(M,T,i)=>{i.d(T,{j:()=>b});var C=i(5619),d=i(8180),x=i(2096),t=i(7772),h=i(5879),y=i(6280),S=i(957);let b=(()=>{class v{constructor(l,p){this.dbService=l,this.infoService=p,this.examples$=new C.X([]),this.sort=(a,m)=>(a.toDoTimestamp||0)-(m.toDoTimestamp||0),this.dbService.getAll(t.L.FavoriteExamples).pipe((0,d.q)(1)).subscribe(a=>{a.forEach(m=>m.showDetails=!1),a?(a.sort(this.sort),this.examples$.next(a)):this.examples$.next([])})}deleteAll(){return this.dbService.clear(t.L.FavoriteExamples)}import(l){const p=JSON.parse(l)?.favoriteExamples;if(!p?.length)return console.error("!examples?.length"),this.infoService.error("!examples?.length"),(0,x.of)([]);const a=this.examples$.value.map(u=>u.timestamp);function m(u){return a.includes(u)?m(u+1):u}return p.forEach(u=>{if(!u.timestamp){const f=m(Date.now());a.push(f),u.timestamp=f}}),this.dbService.bulkAdd(t.L.FavoriteExamples,p).pipe((0,d.q)(1))}addExample(l){const p=Date.now(),a={...l,timestamp:p,showDetails:!1};this.dbService.add(t.L.FavoriteExamples,a).pipe((0,d.q)(1)).subscribe();const m=[a,...this.examples$.value];this.examples$.next(m),this.infoService.show("added: "+l.original)}update(l){if(!l?.timestamp||!l.toDoTimestamp)return;const p=this.examples$.value,a=p.find(m=>m.timestamp===l.timestamp);a&&(a.toDoTimestamp=l.toDoTimestamp,a.updateTimestamp=Date.now(),this.dbService.update(t.L.FavoriteExamples,a).pipe((0,d.q)(1)).subscribe(),p.sort(this.sort),this.examples$.next(p))}removeExample(l){if(!l)return;this.dbService.delete(t.L.FavoriteExamples,l).pipe((0,d.q)(1)).subscribe();const p=this.examples$.value.filter(a=>a.timestamp!==l);this.examples$.next(p)}}return v.\u0275fac=function(l){return new(l||v)(h.LFG(y.ys),h.LFG(S.C))},v.\u0275prov=h.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},3629:(M,T,i)=>{i.r(T),i.d(T,{SettingsComponent:()=>E});var C=i(6814),d=i(2296),x=i(2058),t=i(5879),h=i(5195),y=i(8180),S=i(1839),b=i(144);let v=(()=>{class c{constructor(n,e){this.loader=n,this.exportImportService=e,this.update=new t.vpe}readMorphologyReplaceRules(n){const e=n?.target?.files[0];if(!e)return;const r=new FileReader;r.onload=s=>{const o=s?.target?.result;if(!o)return;const g=this.exportImportService.importMorphologyReplaceRules(o);g&&(this.loader.start(),g.pipe((0,y.q)(1)).subscribe(()=>{this.loader.stop()}))},r.readAsText(e)}readMorphology(n){const e=n?.target?.files[0];if(!e)return;const r=new FileReader;r.onload=s=>{const o=s?.target?.result;if(!o)return;const g=this.exportImportService.importMorphology(o);g&&(this.loader.start(),g.pipe((0,y.q)(1)).subscribe(()=>{this.loader.stop()}))},r.readAsText(e)}readDictionary(n){const e=n?.target?.files[0];if(!e)return;const r=new FileReader;r.onload=s=>{const o=s?.target?.result;if(!o)return;const g=this.exportImportService.importDictionary(o);g&&(this.loader.start(),g.pipe((0,y.q)(1)).subscribe(()=>{this.loader.stop()}))},r.readAsText(e)}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(S.D),t.Y36(b.U))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-import-dictionary"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:18,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["morphologyFileInput",""],["morphologyReplaceRulesFileInput",""],["dictionaryFileInput",""]],template:function(n,e){if(1&n){const r=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," It can take a few minutes to import a large dictionary. You'll have to wait. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){t.CHM(r);const o=t.MAs(13);return t.KtG(o.click())}),t._uU(5," Import (replace) morphology "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(r);const o=t.MAs(15);return t.KtG(o.click())}),t._uU(7," Import (replace) MorphologyReplaceRules "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){t.CHM(r);const o=t.MAs(17);return t.KtG(o.click())}),t._uU(9," Import (replace) dictionary "),t.qZA()(),t.TgZ(10,"div",0),t._uU(11," You have to reload web-application to apply new morphology and/or new dictionary. "),t.qZA()(),t.TgZ(12,"input",3,4),t.NdJ("change",function(o){return e.readMorphology(o)}),t.qZA(),t.TgZ(14,"input",3,5),t.NdJ("change",function(o){return e.readMorphologyReplaceRules(o)}),t.qZA(),t.TgZ(16,"input",3,6),t.NdJ("change",function(o){return e.readDictionary(o)}),t.qZA()}},dependencies:[C.ez,d.ot,d.lW,h.QW,h.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main);margin-top:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),c})();var D=i(8863),p=i(3631);let a=(()=>{class c{constructor(n,e){this.loader=n,this.favoriteExamplesService=e,this.update=new t.vpe,this.datePipe=new C.uU("en")}export(){const n=this.favoriteExamplesService.examples$.value;n?.length&&this.download(function l(c){return JSON.stringify(c,null,2)}({favoriteExamples:n}),"favorite-examples")}import(n){const e=n?.target?.files[0];if(!e)return;const r=new FileReader;r.onload=s=>{const o=s?.target?.result;if(!o)return;const g=this.favoriteExamplesService.import(o);g&&(this.loader.start(),g.pipe((0,y.q)(1)).subscribe(A=>{this.loader.stop()}))},r.readAsText(e)}deleteAll(){window.confirm("Delete all?")&&(this.loader.start(),this.favoriteExamplesService.deleteAll().pipe((0,y.q)(1)).subscribe(e=>{this.loader.stop()}))}download(n,e){const r=this.datePipe.transform(new Date,"yyyy-MM-dd");(0,D.l)(n,e+`.${r}.json`)}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(S.D),t.Y36(p.j))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-import-favorite-example"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:12,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["importFileInput",""]],template:function(n,e){if(1&n){const r=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," Favorite examples. You have to reload page after import. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){return e.export()}),t._uU(5," Export Favorites "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(r);const o=t.MAs(11);return t.KtG(o.click())}),t._uU(7," Import (add) Favorites "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return e.deleteAll()}),t._uU(9," Delete all Favorites "),t.qZA()()(),t.TgZ(10,"input",3,4),t.NdJ("change",function(o){return e.import(o)}),t.qZA()}},dependencies:[C.ez,d.ot,d.lW,h.QW,h.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),c})();var m=i(9157),u=i(2032),f=i(6223),k=i(8805),Z=i(2969);let E=(()=>{class c{constructor(n,e){this.customStylesService=n,this.localStorageService=e,this.copyToClipboardState=this.localStorageService.copyToClipboard,this.showDictionaryState=this.localStorageService.showDictionary,this.showTranslationState=this.localStorageService.showTranslationInBook,this.ankiHost=this.localStorageService.ankiHost,this.ankiDeck=this.localStorageService.ankiDeck}copyToClipboard(n){this.localStorageService.copyToClipboard=n,this.copyToClipboardState=n}showDictionary(n){this.localStorageService.showDictionary=n,this.showDictionaryState=n}setAnkiHost(){this.localStorageService.ankiHost=this.ankiHost}setAnkiDeck(){this.localStorageService.ankiDeck=this.ankiDeck}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(k.N),t.Y36(Z.n))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-settings"]],standalone:!0,features:[t.jDz],decls:37,vars:4,consts:[[1,"component-content"],[1,"header"],["mat-button","","color","primary","routerLink","/"],[1,"title"],[1,"settings"],[1,"divider"],[1,"setting-item"],["mat-button","","color","primary",3,"click"],[1,"text-area"],["matInput","",3,"ngModel","ngModelChange"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._uU(3," Go Home. "),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Settings"),t.qZA()(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return e.customStylesService.resetAllStyles()}),t._uU(10," Reset all styles "),t.qZA()(),t._UZ(11,"div",5),t.TgZ(12,"div",6)(13,"button",7),t.NdJ("click",function(){return e.copyToClipboard(!e.copyToClipboardState)}),t._uU(14),t.qZA()(),t._UZ(15,"div",5),t.TgZ(16,"div",6)(17,"mat-form-field",8)(18,"mat-label"),t._uU(19," ankiHost "),t.qZA(),t.TgZ(20,"input",9),t.NdJ("ngModelChange",function(s){return e.ankiHost=s}),t.qZA()(),t.TgZ(21,"button",7),t.NdJ("click",function(){return e.setAnkiHost()}),t._uU(22," setAnkiHost "),t.qZA()(),t.TgZ(23,"div",6)(24,"mat-form-field",8)(25,"mat-label"),t._uU(26," ankiDeck "),t.qZA(),t.TgZ(27,"input",9),t.NdJ("ngModelChange",function(s){return e.ankiDeck=s}),t.qZA()(),t.TgZ(28,"button",7),t.NdJ("click",function(){return e.setAnkiDeck()}),t._uU(29," setAnkiDeck "),t.qZA()(),t._UZ(30,"div",5),t.TgZ(31,"div",6)(32,"button",7),t.NdJ("click",function(){return e.showDictionary(!e.showDictionaryState)}),t._uU(33),t.qZA()(),t._UZ(34,"div",5)(35,"app-import-dictionary")(36,"app-import-favorite-example"),t.qZA()()),2&n&&(t.xp6(14),t.hij(" Copy to clipboard: ",e.copyToClipboardState," "),t.xp6(6),t.Q6J("ngModel",e.ankiHost),t.xp6(7),t.Q6J("ngModel",e.ankiDeck),t.xp6(6),t.hij(" Show dictionary: ",e.showDictionaryState," "))},dependencies:[C.ez,d.ot,d.lW,x.rH,v,a,m.lN,m.KE,m.hX,u.c,u.Nt,f.UX,f.Fj,f.JJ,f.u5,f.On],styles:[".component-content[_ngcontent-%COMP%]{padding:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.component-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%;min-width:100%;border-top:1px dashed gray;margin:var(--padding-main) 0}.component-content[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]{justify-content:center;display:flex;gap:8px;align-items:center}"]}),c})()}}]);