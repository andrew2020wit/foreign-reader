"use strict";(self.webpackChunkforeign_reader=self.webpackChunkforeign_reader||[]).push([[629],{5152:(D,T,r)=>{r.d(T,{N:()=>v});var p=r(5619);const g=[{label:"Font size original text (26px)",cssVariable:"--font-size-original-text"},{label:"Font size translation text (24px)",cssVariable:"--font-size-translation-text"},{label:"dictionary-main-font-size",cssVariable:"--dictionary-main-font-size"},{label:"dictionary-header-font-size",cssVariable:"--dictionary-header-font-size"},{label:"Main background color",cssVariable:"--background-color-main"},{label:'background-image, like: url(https://andrew2020wit.github.io/foreign-reader/assets/background/fancy-deboss.png) or "none"',cssVariable:"--book-background-image"},{label:"Accent background color (header)",cssVariable:"--background-color-accent"},{label:"Main font color (original text)",cssVariable:"--font-color-main"},{label:"Translation font color",cssVariable:"--font-color-translation"},{label:"Accent font color (header)",cssVariable:"--font-color-accent"},{label:"Color primary",cssVariable:"--color-primary"},{label:"Color accent",cssVariable:"--color-accent"},{label:"Color warn",cssVariable:"--color-warn"},{label:"Dictionary width",cssVariable:"--dictionary-width"},{label:"--max-book-width",cssVariable:"--max-book-width"},{label:'Font family ("Segoe UI", roboto, verdana, sans-serif)',cssVariable:"--font-family"}];var x=r(5879),t=r(2969);let v=(()=>{class e{constructor(a){this.localStorageService=a,this.customStyles$=new p.X([]);const d=[];g.forEach(C=>{d.push({...C,value:this.localStorageService.getString(C.cssVariable)})}),this.customStyles$.next(d)}setStyle(a,d){this.localStorageService.setString(a,d);const C=this.customStyles$.value,s=C.find(h=>h.cssVariable===a);s&&(s.value=d,this.customStyles$.next([...C]))}resetAllStyles(){const a=[];g.forEach(d=>{a.push({...d,value:""}),this.localStorageService.setString(d.cssVariable,"")}),this.customStyles$.next(a)}}return e.\u0275fac=function(a){return new(a||e)(x.LFG(t.n))},e.\u0275prov=x.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},5709:(D,T,r)=>{r.d(T,{j:()=>a});var p=r(5619),g=r(8180),x=r(2096),t=r(7772),v=r(5879),e=r(6280),m=r(957);let a=(()=>{class d{constructor(s,h){this.dbService=s,this.infoService=h,this.examples$=new p.X([]),this.sort=(c,y)=>(c.toDoTimestamp||0)-(y.toDoTimestamp||0),this.dbService.getAll(t.L.FavoriteExamples).pipe((0,g.q)(1)).subscribe(c=>{c.forEach(y=>y.showDetails=!1),c?(c.sort(this.sort),this.examples$.next(c)):this.examples$.next([])})}deleteAll(){return this.dbService.clear(t.L.FavoriteExamples)}import(s){const h=JSON.parse(s)?.favoriteExamples;if(!h?.length)return console.error("!examples?.length"),this.infoService.error("!examples?.length"),(0,x.of)([]);const c=this.examples$.value.map(S=>S.timestamp);function y(S){return c.includes(S)?y(S+1):S}return h.forEach(S=>{if(!S.timestamp){const M=y(Date.now());c.push(M),S.timestamp=M}}),this.dbService.bulkAdd(t.L.FavoriteExamples,h).pipe((0,g.q)(1))}addExample(s){const h=Date.now(),c={...s,timestamp:h,showDetails:!1};this.dbService.add(t.L.FavoriteExamples,c).pipe((0,g.q)(1)).subscribe();const y=[c,...this.examples$.value];this.examples$.next(y),this.infoService.show("added: "+s.original)}update(s){if(!s?.timestamp||!s.toDoTimestamp)return;const h=this.examples$.value,c=h.find(y=>y.timestamp===s.timestamp);c&&(c.toDoTimestamp=s.toDoTimestamp,c.updateTimestamp=Date.now(),this.dbService.update(t.L.FavoriteExamples,c).pipe((0,g.q)(1)).subscribe(),h.sort(this.sort),this.examples$.next(h))}removeExample(s){if(!s)return;this.dbService.delete(t.L.FavoriteExamples,s).pipe((0,g.q)(1)).subscribe();const h=this.examples$.value.filter(c=>c.timestamp!==s);this.examples$.next(h)}}return d.\u0275fac=function(s){return new(s||d)(v.LFG(e.ys),v.LFG(m.C))},d.\u0275prov=v.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},3629:(D,T,r)=>{r.r(T),r.d(T,{SettingsComponent:()=>M});var p=r(6814),g=r(2296),x=r(2058),t=r(5879),v=r(5195),e=r(8180),m=r(1839),a=r(144);let d=(()=>{class u{constructor(o,n){this.loader=o,this.exportImportService=n,this.update=new t.vpe}readMorphologyReplaceRules(o){const n=o?.target?.files[0];if(!n)return;const l=new FileReader;l.onload=f=>{const i=f?.target?.result;if(!i)return;const b=this.exportImportService.importMorphologyReplaceRules(i);b&&(this.loader.start(),b.pipe((0,e.q)(1)).subscribe(()=>{this.loader.stop()}))},l.readAsText(n)}readMorphology(o){const n=o?.target?.files[0];if(!n)return;const l=new FileReader;l.onload=f=>{const i=f?.target?.result;if(!i)return;const b=this.exportImportService.importMorphology(i);b&&(this.loader.start(),b.pipe((0,e.q)(1)).subscribe(()=>{this.loader.stop()}))},l.readAsText(n)}readDictionary(o){const n=o?.target?.files[0];if(!n)return;const l=new FileReader;l.onload=f=>{const i=f?.target?.result;if(!i)return;const b=this.exportImportService.importDictionary(i);b&&(this.loader.start(),b.pipe((0,e.q)(1)).subscribe(()=>{this.loader.stop()}))},l.readAsText(n)}}return u.\u0275fac=function(o){return new(o||u)(t.Y36(m.D),t.Y36(a.U))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-import-dictionary"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:18,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["morphologyFileInput",""],["morphologyReplaceRulesFileInput",""],["dictionaryFileInput",""]],template:function(o,n){if(1&o){const l=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," It can take a few minutes to import a large dictionary. You'll have to wait. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){t.CHM(l);const i=t.MAs(13);return t.KtG(i.click())}),t._uU(5," Import (replace) morphology "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(l);const i=t.MAs(15);return t.KtG(i.click())}),t._uU(7," Import (replace) MorphologyReplaceRules "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){t.CHM(l);const i=t.MAs(17);return t.KtG(i.click())}),t._uU(9," Import (replace) dictionary "),t.qZA()(),t.TgZ(10,"div",0),t._uU(11," You have to reload web-application to apply new morphology and/or new dictionary. "),t.qZA()(),t.TgZ(12,"input",3,4),t.NdJ("change",function(i){return n.readMorphology(i)}),t.qZA(),t.TgZ(14,"input",3,5),t.NdJ("change",function(i){return n.readMorphologyReplaceRules(i)}),t.qZA(),t.TgZ(16,"input",3,6),t.NdJ("change",function(i){return n.readDictionary(i)}),t.qZA()}},dependencies:[p.ez,g.ot,g.lW,v.QW,v.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main);margin-top:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),u})();var C=r(8863),h=r(5709);let c=(()=>{class u{constructor(o,n){this.loader=o,this.favoriteExamplesService=n,this.update=new t.vpe,this.datePipe=new p.uU("en")}export(){const o=this.favoriteExamplesService.examples$.value;o?.length&&this.download(function s(u){return JSON.stringify(u,null,2)}({favoriteExamples:o}),"favorite-examples")}import(o){const n=o?.target?.files[0];if(!n)return;const l=new FileReader;l.onload=f=>{const i=f?.target?.result;if(!i)return;const b=this.favoriteExamplesService.import(i);b&&(this.loader.start(),b.pipe((0,e.q)(1)).subscribe(w=>{this.loader.stop()}))},l.readAsText(n)}deleteAll(){window.confirm("Delete all?")&&(this.loader.start(),this.favoriteExamplesService.deleteAll().pipe((0,e.q)(1)).subscribe(n=>{this.loader.stop()}))}download(o,n){const l=this.datePipe.transform(new Date,"yyyy-MM-dd");(0,C.l)(o,n+`.${l}.json`)}}return u.\u0275fac=function(o){return new(o||u)(t.Y36(m.D),t.Y36(h.j))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-import-favorite-example"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:12,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["importFileInput",""]],template:function(o,n){if(1&o){const l=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," Favorite examples. You have to reload page after import. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){return n.export()}),t._uU(5," Export Favorites "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(l);const i=t.MAs(11);return t.KtG(i.click())}),t._uU(7," Import (add) Favorites "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return n.deleteAll()}),t._uU(9," Delete all Favorites "),t.qZA()()(),t.TgZ(10,"input",3,4),t.NdJ("change",function(i){return n.import(i)}),t.qZA()}},dependencies:[p.ez,g.ot,g.lW,v.QW,v.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),u})();var y=r(5152),S=r(2969);let M=(()=>{class u{constructor(o,n){this.customStylesService=o,this.localStorageService=n,this.copyToClipboardState=this.localStorageService.copyToClipboard,this.showDictionaryState=this.localStorageService.showDictionary,this.showTranslationState=this.localStorageService.showTranslationInBook}copyToClipboard(o){this.localStorageService.copyToClipboard=o,this.copyToClipboardState=o}showDictionary(o){this.localStorageService.showDictionary=o,this.showDictionaryState=o}}return u.\u0275fac=function(o){return new(o||u)(t.Y36(y.N),t.Y36(S.n))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-settings"]],standalone:!0,features:[t.jDz],decls:22,vars:2,consts:[[1,"component-content"],[1,"header"],["mat-button","","color","primary","routerLink","/"],[1,"title"],[1,"settings"],[1,"divider"],[1,"setting-item"],["mat-button","","color","primary",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._uU(3," Go Home. "),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Settings"),t.qZA()(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return n.customStylesService.resetAllStyles()}),t._uU(10," Reset all styles "),t.qZA()(),t._UZ(11,"div",5),t.TgZ(12,"div",6)(13,"button",7),t.NdJ("click",function(){return n.copyToClipboard(!n.copyToClipboardState)}),t._uU(14),t.qZA()(),t._UZ(15,"div",5),t.TgZ(16,"div",6)(17,"button",7),t.NdJ("click",function(){return n.showDictionary(!n.showDictionaryState)}),t._uU(18),t.qZA()(),t._UZ(19,"div",5)(20,"app-import-dictionary")(21,"app-import-favorite-example"),t.qZA()()),2&o&&(t.xp6(14),t.hij(" Copy to clipboard: ",n.copyToClipboardState," "),t.xp6(4),t.hij(" Show dictionary: ",n.showDictionaryState," "))},dependencies:[p.ez,g.ot,g.lW,x.rH,d,c],styles:[".component-content[_ngcontent-%COMP%]{padding:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.component-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%;min-width:100%;border-top:1px dashed gray;margin:var(--padding-main) 0}.component-content[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]{justify-content:center;display:flex}"]}),u})()},2969:(D,T,r)=>{r.d(T,{n:()=>x});var p=function(t){return t.CurrentPopupMenuTab="CurrentPopupMenuTab",t.CopyToClipboard="CopyToClipboard",t.ShowDictionary="ShowDictionary",t.HideMarkedHeaders="HideMarkedHeaders",t.ShowTranslationInBook="ShowTranslationInBook",t.AutoTranslateSelected="AutoTranslateSelected",t.ShowTranslatorInDictionaryViewer="ShowTranslatorInDictionaryViewer",t}(p||{}),g=r(5879);let x=(()=>{class t{get hideMarkedHeaders(){return this.getBoolean(p.HideMarkedHeaders,!1)}set hideMarkedHeaders(e){this.setBoolean(p.HideMarkedHeaders,e)}get copyToClipboard(){return this.getBoolean(p.CopyToClipboard,!1)}set copyToClipboard(e){this.setBoolean(p.CopyToClipboard,e)}get showDictionary(){return this.getBoolean(p.ShowDictionary,!0)}set showDictionary(e){this.setBoolean(p.ShowDictionary,e)}get showTranslationInBook(){return this.getBoolean(p.ShowTranslationInBook,!0)}set showTranslationInBook(e){this.setBoolean(p.ShowTranslationInBook,e)}get currentPopupMenuTab(){return this.getNumber(p.CurrentPopupMenuTab)}set currentPopupMenuTab(e){this.setNumber(p.CurrentPopupMenuTab,e||0)}constructor(){this.trueString="true",this.falseString="false"}getString(e,m=""){return localStorage.getItem(e)||m}setString(e,m){localStorage.setItem(e,m)}setNumber(e,m){localStorage.setItem(e,String(m||0))}getNumber(e,m=0){const a=localStorage.getItem(e);if(null===a)return m;const d=+a;return Number.isNaN(d)?m:d}setBoolean(e,m){localStorage.setItem(e,m?this.trueString:this.falseString)}getBoolean(e,m=!1){const a=localStorage.getItem(e);return a===this.trueString||a!==this.falseString&&m}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=g.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);