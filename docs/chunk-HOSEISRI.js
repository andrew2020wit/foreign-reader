import{a as Y,b as Z,c as $,d as ee,f as te,g as oe}from"./chunk-JNVOQL22.js";import{a as y,b as w,c as ne}from"./chunk-N4FDZVII.js";import{p as ie}from"./chunk-EDACHHSA.js";import{b as N,f as D,k as Q,p as j,s as B,v as H,w as K,x as G,y as U}from"./chunk-PZ7MFQJW.js";import{D as M,Ga as h,Hb as A,Ka as g,Ma as L,Qa as v,Sa as P,Ta as S,Ua as W,Va as n,Wa as o,Za as f,_ as I,ab as d,cb as m,ec as V,fa as u,ga as p,j as O,mb as l,ob as k,pb as R,qb as E,rb as C,rd as z,sb as x,sd as J,tb as b,td as X,va as a,vb as q,wa as _}from"./chunk-OUFBJRPP.js";function ae(c,i){if(c&1){let e=f();n(0,"div",3)(1,"button",20),d("click",function(){u(e);let r=m();return p(r.searchAll())}),l(2," Search All "),o()()}}function le(c,i){if(c&1){let e=f();n(0,"div",4)(1,"div",21)(2,"button",22),d("click",function(){let r=u(e).$implicit,s=m();return p(s.remove(r))}),n(3,"mat-icon"),l(4,"star"),o()()(),n(5,"div",23),d("click",function(){let r=u(e).$implicit,s=m();return p(s.selectTerm(r))}),n(6,"button",24),l(7),o()()()}if(c&2){let e=i.$implicit;a(2),g("color","accent"),a(5),k(" ",e," ")}}function se(c,i){if(c&1){let e=f();n(0,"div",3)(1,"button",25),d("click",function(){u(e);let r=m();return p(r.deleteAll())}),l(2," Delete All "),o()()}}function ce(c,i){if(c&1){let e=f();n(0,"div",14)(1,"button",13),d("click",function(){u(e);let r=m();return p(r.selectAll())}),l(2," Select All "),o(),n(3,"button",13),d("click",function(){u(e);let r=m();return p(r.deselectAll())}),l(4," Deselect "),o(),n(5,"button",13),d("click",function(){u(e);let r=m();return p(r.addTag())}),l(6," Add tag to selected "),o()()}if(c&2){let e=m();a(),g("disabled",!e.ankiRequestText),a(2),g("disabled",!e.ankiRequestText),a(2),g("disabled",!e.ankiRequestText)}}function de(c,i){if(c&1&&(n(0,"div",30),l(1),o()),c&2){let e=m().$implicit;a(),k(" tags: ",e.tags==null?null:e.tags.join(" | ")," ")}}function me(c,i){if(c&1){let e=f();n(0,"div",26),d("click",function(){let r=u(e).$implicit;return p(r.selected=!r.selected)}),n(1,"div",27),l(2),o(),n(3,"div",28),l(4),o(),n(5,"div",29),l(6),o(),h(7,de,2,1,"div",30),o()}if(c&2){let e=i.$implicit;L("selected",e.selected),a(2),E(" ",e.fields.term==null?null:e.fields.term.value," (",e.fields.pos==null?null:e.fields.pos.value,") ",e.fields.freq==null?null:e.fields.freq.value," ",e.fields.freq2==null?null:e.fields.freq2.value," [ ",e.modelName," ",e.fields.sensenum==null?null:e.fields.sensenum.value," ",e.fields.exampleId==null?null:e.fields.exampleId.value," ] "),a(2),k(" ",e.fields.exampleText==null?null:e.fields.exampleText.value," "),a(2),k(" ",e.fields.def==null?null:e.fields.def.value," "),a(),v(e.tags!=null&&e.tags.length?7:-1)}}var re=class T{constructor(i,e,t,r,s){this.favoriteWordsService=i,this.ankiConnectService=e,this.cdr=t,this.info=r,this.localStorageService=s,this.favoriteWordList=[],this.textForImport="",this.ankiHost=this.localStorageService.ankiHost,this.ankiDeck=this.localStorageService.ankiDeck,this.tag=localStorage.getItem(y)||"selected",this.ankiRequestText=localStorage.getItem(w)||"flag:2",this.ankiResultList=[],this.resultNumber=0,this.maxAnkiResultNumber=500,this.searchQueue=[]}ngOnInit(){this.favoriteWordsService.getAll().pipe(ee(this)).subscribe(i=>{this.favoriteWordList=i||[],this.cdr.detectChanges()})}searchAll(){this.searchQueue=[...this.favoriteWordList],this.checkSearchQueue()}checkSearchQueue(i=""){i&&(this.searchQueue=this.searchQueue.filter(e=>e!==i)),this.searchQueue.length!==0&&this.selectTerm(this.searchQueue[0])}selectAll(){this.ankiResultList.forEach(i=>i.selected=!0),this.cdr.detectChanges()}deselectAll(){this.ankiResultList.forEach(i=>i.selected=!1),this.cdr.detectChanges()}selectTerm(i){let e="";this.ankiDeck&&(e+="deck:"+this.ankiDeck+" "),e+='term:"'+i+'"',this.ankiRequestText=e,this.request(e,i)}addTag(){if(!this.tag){this.info.error("Wrong tag");return}let i=this.ankiResultList.filter(e=>e.selected&&!e.tags?.includes(this.tag)).map(e=>e.noteId);if(!i.length){this.info.error("Nothing to add!");return}localStorage.setItem(y,this.tag),this.ankiConnectService.addTagForNotes(i,this.tag)}request(i=this.ankiRequestText,e){i&&(localStorage.setItem(w,this.ankiRequestText),this.ankiConnectService.findNotes(i).pipe(M(1)).subscribe(t=>{this.searchQueue.length===0?(this.resultNumber=t.length,this.ankiResultList=t.slice(0,500)):(this.resultNumber+=t.length,this.ankiResultList.push(...t.slice(0,500))),this.checkSearchQueue(e),this.cdr.detectChanges()}))}importText(){let i=this.textForImport.split(`
`).map(e=>e.trim()).filter(e=>!this.favoriteWordList.includes(e));this.favoriteWordsService.importWords(i).pipe(M(1)).subscribe(),this.textForImport="",this.favoriteWordList=[...this.favoriteWordList,...i],this.cdr.detectChanges()}remove(i){this.favoriteWordsService.remove(i),this.favoriteWordList=this.favoriteWordList.filter(e=>e!==i),this.ankiResultList=[],this.resultNumber=0,this.cdr.detectChanges()}deleteAll(){this.favoriteWordsService.deleteAll(),this.favoriteWordList=[],this.ankiResultList=[],this.resultNumber=0,this.cdr.detectChanges()}static{this.\u0275fac=function(e){return new(e||T)(_(te),_(oe),_(A),_(ie),_(ne))}}static{this.\u0275cmp=I({type:T,selectors:[["app-favorite-word-page"]],standalone:!0,features:[q],decls:36,vars:10,consts:[[1,"top-block"],[1,"favorite-word-list"],["mat-button","","color","primary","routerLink","/"],[1,"remove-button"],[1,"favorite-word-list-item"],[1,"anki-connect-block"],[1,"settings"],[1,"anki-result-sum"],["appearance","outline"],["matInput","",1,"flag-input",3,"ngModelChange","ngModel"],[1,"anki-request"],["appearance","outline",1,"request-mat-form-field"],["matInput","",1,"flag-input",3,"keydown.enter","ngModelChange","ngModel"],["mat-button","","color","primary",3,"click","disabled"],[1,"buttons"],[1,"result-items"],[1,"result-item",3,"selected"],[1,"import-block"],["appearance","outline",1,"description"],["matInput","",1,"import-text-area",3,"ngModelChange","ngModel"],["mat-button","","color","primary",1,"term-button",3,"click"],[1,"star"],["mat-icon-button","",1,"favorite-word-button",3,"click","color"],[1,"term",3,"click"],["mat-button","","color","primary",1,"term-button"],["mat-button","","color","warn",1,"term-button",3,"click"],[1,"result-item",3,"click"],[1,"top"],[1,"example"],[1,"def"],[1,"tags"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),l(3," Home "),o(),h(4,ae,3,0,"div",3),S(5,le,8,2,"div",4,P),h(7,se,3,0,"div",3),o(),n(8,"div",5)(9,"div",6)(10,"div",7),l(11),o(),n(12,"mat-form-field",8)(13,"mat-label"),l(14,"Anki tag to add"),o(),n(15,"input",9),b("ngModelChange",function(s){return x(t.tag,s)||(t.tag=s),s}),o()()(),n(16,"div",10)(17,"mat-form-field",11)(18,"mat-label"),l(19,"Anki request text"),o(),n(20,"input",12),d("keydown.enter",function(){return t.request()}),b("ngModelChange",function(s){return x(t.ankiRequestText,s)||(t.ankiRequestText=s),s}),o()(),n(21,"button",13),d("click",function(){return t.request()}),l(22,"Go! "),o()(),h(23,ce,7,3,"div",14),n(24,"div",15),S(25,me,8,12,"div",16,P),o()()(),n(27,"h2"),l(28,"Import"),o(),n(29,"div",17)(30,"mat-form-field",18)(31,"mat-label"),l(32,"Words to import"),o(),n(33,"textarea",19),b("ngModelChange",function(s){return x(t.textForImport,s)||(t.textForImport=s),s}),o()(),n(34,"button",13),d("click",function(){return t.importText()}),l(35,"Import "),o()()),e&2&&(a(4),v(t.favoriteWordList.length&&t.favoriteWordList.length>1?4:-1),a(),W(t.favoriteWordList),a(2),v(t.favoriteWordList.length&&t.favoriteWordList.length>1?7:-1),a(4),R(" Anki-connect, resultNumber: ",t.resultNumber,", max: ",t.maxAnkiResultNumber," "),a(4),C("ngModel",t.tag),a(5),C("ngModel",t.ankiRequestText),a(),g("disabled",!t.ankiRequestText),a(2),v(t.ankiResultList!=null&&t.ankiResultList.length?23:-1),a(2),W(t.ankiResultList),a(8),C("ngModel",t.textForImport),a(),g("disabled",!t.textForImport))},dependencies:[X,z,J,Z,Y,K,H,B,j,N,D,Q,U,G,V],styles:["[_nghost-%COMP%]{display:block;padding:24px}.top-block[_ngcontent-%COMP%]{display:flex;gap:8px}.anki-connect-block[_ngcontent-%COMP%]{flex:1}.anki-connect-block[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:start;gap:8px}.anki-connect-block[_ngcontent-%COMP%]   .anki-request[_ngcontent-%COMP%]{width:100%;display:flex;gap:8px}.anki-connect-block[_ngcontent-%COMP%]   .anki-request[_ngcontent-%COMP%]   .request-mat-form-field[_ngcontent-%COMP%]{flex:1}.anki-connect-block[_ngcontent-%COMP%]   .anki-result-sum[_ngcontent-%COMP%]{color:#00f}.anki-connect-block[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.anki-connect-block[_ngcontent-%COMP%]   .result-items[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]{border:1px solid lightgray;margin:16px 0;padding:4px 8px;cursor:pointer}.anki-connect-block[_ngcontent-%COMP%]   .result-items[_ngcontent-%COMP%]   .result-item.selected[_ngcontent-%COMP%]{border:1px solid green}.anki-connect-block[_ngcontent-%COMP%]   .result-items[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{color:gray}.anki-connect-block[_ngcontent-%COMP%]   .result-items[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]   .example[_ngcontent-%COMP%]{margin:8px 0}.anki-connect-block[_ngcontent-%COMP%]   .result-items[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]   .def[_ngcontent-%COMP%]{color:gray}.anki-connect-block[_ngcontent-%COMP%]   .result-items[_ngcontent-%COMP%]   .result-item[_ngcontent-%COMP%]   .tags[_ngcontent-%COMP%]{color:green}.favorite-word-list[_ngcontent-%COMP%]   .favorite-word-list-item[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.favorite-word-list[_ngcontent-%COMP%]   .term-button[_ngcontent-%COMP%]{justify-content:start;max-width:200px;min-width:100px;overflow:clip}.import-block[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 100px}.import-block[_ngcontent-%COMP%]   .import-text-area[_ngcontent-%COMP%]{height:400px}"]})}};re=O([$()],re);export{re as FavoriteWordPageComponent};
