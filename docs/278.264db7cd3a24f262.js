"use strict";(self.webpackChunkforeign_reader=self.webpackChunkforeign_reader||[]).push([[278],{5709:(D,C,r)=>{r.d(C,{j:()=>b});var i=r(5619),h=r(8180),M=r(2096),t=r(7772),v=r(5879),_=r(2e3),d=r(957);let b=(()=>{class n{constructor(a,l){this.dbService=a,this.infoService=l,this.examples$=new i.X([]),this.sort=(m,f)=>(m.toDoTimestamp||0)-(f.toDoTimestamp||0),this.dbService.getAll(t.L6.FavoriteExamples).pipe((0,h.q)(1)).subscribe(m=>{m.forEach(f=>f.showDetails=!1),m?(m.sort(this.sort),this.examples$.next(m)):this.examples$.next([])})}deleteAll(){return this.dbService.clear(t.L6.FavoriteExamples)}import(a){const l=JSON.parse(a)?.favoriteExamples;return l?.length?this.dbService.bulkAdd(t.L6.FavoriteExamples,l).pipe((0,h.q)(1)):(console.error("!examples?.length"),this.infoService.error("!examples?.length"),(0,M.of)([]))}addExample(a){const l=Date.now(),m={...a,timestamp:l,showDetails:!1};this.dbService.add(t.L6.FavoriteExamples,m).pipe((0,h.q)(1)).subscribe();const f=[m,...this.examples$.value];this.examples$.next(f),this.infoService.show("added: "+a.original)}update(a){if(!a?.timestamp||!a.toDoTimestamp)return;const l=this.examples$.value,m=l.find(f=>f.timestamp===a.timestamp);m&&(m.toDoTimestamp=a.toDoTimestamp,m.updateTimestamp=Date.now(),this.dbService.update(t.L6.FavoriteExamples,m).pipe((0,h.q)(1)).subscribe(),l.sort(this.sort),this.examples$.next(l))}removeExample(a){if(!a)return;this.dbService.delete(t.L6.FavoriteExamples,a).pipe((0,h.q)(1)).subscribe();const l=this.examples$.value.filter(m=>m.timestamp!==a);this.examples$.next(l)}}return n.\u0275fac=function(a){return new(a||n)(v.LFG(_.ys),v.LFG(d.C))},n.\u0275prov=v.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},2278:(D,C,r)=>{r.r(C),r.d(C,{SettingsComponent:()=>w});var i=r(6814),h=r(2296),M=r(4408),t=r(5879),v=r(5195),_=r(8180),d=r(1839),b=r(144);let n=(()=>{class p{constructor(o,e){this.loader=o,this.exportImportService=e,this.update=new t.vpe}readMorphologyReplaceRules(o){const e=o?.target?.files[0];if(!e)return;const s=new FileReader;s.onload=u=>{const c=u?.target?.result;if(!c)return;const S=this.exportImportService.importMorphologyReplaceRules(c);S&&(this.loader.start(),S.pipe((0,_.q)(1)).subscribe(()=>{this.loader.stop()}))},s.readAsText(e)}readMorphology(o){const e=o?.target?.files[0];if(!e)return;const s=new FileReader;s.onload=u=>{const c=u?.target?.result;if(!c)return;const S=this.exportImportService.importMorphology(c);S&&(this.loader.start(),S.pipe((0,_.q)(1)).subscribe(()=>{this.loader.stop()}))},s.readAsText(e)}readDictionary(o){const e=o?.target?.files[0];if(!e)return;const s=new FileReader;s.onload=u=>{const c=u?.target?.result;if(!c)return;const S=this.exportImportService.importDictionary(c);S&&(this.loader.start(),S.pipe((0,_.q)(1)).subscribe(()=>{this.loader.stop()}))},s.readAsText(e)}}return p.\u0275fac=function(o){return new(o||p)(t.Y36(d.D),t.Y36(b.U))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-import-dictionary"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:18,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["morphologyFileInput",""],["morphologyReplaceRulesFileInput",""],["dictionaryFileInput",""]],template:function(o,e){if(1&o){const s=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," It can take a few minutes to import a large dictionary. You'll have to wait. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){t.CHM(s);const c=t.MAs(13);return t.KtG(c.click())}),t._uU(5," Import (replace) morphology "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(s);const c=t.MAs(15);return t.KtG(c.click())}),t._uU(7," Import (replace) MorphologyReplaceRules "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){t.CHM(s);const c=t.MAs(17);return t.KtG(c.click())}),t._uU(9," Import (replace) dictionary "),t.qZA()(),t.TgZ(10,"div",0),t._uU(11," You have to reload web-application to apply new morphology and/or new dictionary. "),t.qZA()(),t.TgZ(12,"input",3,4),t.NdJ("change",function(c){return e.readMorphology(c)}),t.qZA(),t.TgZ(14,"input",3,5),t.NdJ("change",function(c){return e.readMorphologyReplaceRules(c)}),t.qZA(),t.TgZ(16,"input",3,6),t.NdJ("change",function(c){return e.readDictionary(c)}),t.qZA()}},dependencies:[i.ez,h.ot,h.lW,v.QW,v.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main);margin-top:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),p})();var l=r(5709);let m=(()=>{class p{constructor(o,e){this.loader=o,this.favoriteExamplesService=e,this.update=new t.vpe,this.datePipe=new i.uU("en")}export(){const o=this.favoriteExamplesService.examples$.value;o?.length&&this.download(function a(p){return JSON.stringify(p,null,2)}({favoriteExamples:o}),"favorite-examples")}import(o){const e=o?.target?.files[0];if(!e)return;const s=new FileReader;s.onload=u=>{const c=u?.target?.result;if(!c)return;const S=this.favoriteExamplesService.import(c);S&&(this.loader.start(),S.pipe((0,_.q)(1)).subscribe(F=>{this.loader.stop()}))},s.readAsText(e)}deleteAll(){window.confirm("Delete all?")&&(this.loader.start(),this.favoriteExamplesService.deleteAll().pipe((0,_.q)(1)).subscribe(e=>{this.loader.stop()}))}download(o,e){!function g(p,T){const e=document.createElement("a"),s=new Blob([p],{type:"text/plain"});e.href=URL.createObjectURL(s),e.download=T,e.click(),e.remove()}(o,e+`.${this.datePipe.transform(new Date,"yyyy-MM-dd")}.json`)}}return p.\u0275fac=function(o){return new(o||p)(t.Y36(d.D),t.Y36(l.j))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-import-favorite-example"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:12,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["importFileInput",""]],template:function(o,e){if(1&o){const s=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," Favorite examples. You have to reload page after import. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){return e.export()}),t._uU(5," Export Favorites "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(s);const c=t.MAs(11);return t.KtG(c.click())}),t._uU(7," Import (add) Favorites "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return e.deleteAll()}),t._uU(9," Delete all Favorites "),t.qZA()()(),t.TgZ(10,"input",3,4),t.NdJ("change",function(c){return e.import(c)}),t.qZA()}},dependencies:[i.ez,h.ot,h.lW,v.QW,v.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),p})();var f=r(6223),y=r(9157),x=r(2032),E=r(4716),I=r(3890),A=r(957),O=r(2875);let P=(()=>{class p{constructor(o,e,s,u,c){this.loader=o,this.translatorService=e,this.info=s,this.cdr=u,this.localStorageService=c,this.testOriginal="Hello world!",this.testTranslation="",this.url="",this.from="",this.to="",this.url=this.localStorageService.translationUrl,this.from=this.localStorageService.translationFrom,this.to=this.localStorageService.translationTo}test(){this.loader.topOn(),this.translatorService.getTranslation(this.testOriginal).pipe((0,_.q)(1),(0,E.x)(()=>this.loader.topOff())).subscribe({next:o=>{this.testTranslation=o.translation,this.cdr.detectChanges()},error:o=>{console.error(o),this.info.error(o.message||"Some error")}})}save(){!this.url||!this.from||!this.to||(this.localStorageService.translationUrl=this.url,this.localStorageService.translationFrom=this.from,this.localStorageService.translationTo=this.to)}}return p.\u0275fac=function(o){return new(o||p)(t.Y36(d.D),t.Y36(I.Q),t.Y36(A.C),t.Y36(t.sBO),t.Y36(O.n))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-translator-settings"]],standalone:!0,features:[t.jDz],decls:23,vars:6,consts:[[1,"main-card"],[1,"info"],[1,"url"],["appearance","outline",1,"url-input"],["matInput","","required","",3,"ngModel","ngModelChange"],[1,"langs"],["appearance","outline",1,"input"],["mat-button","","color","primary",3,"disabled","click"],[1,"test-result"],["mat-button","","color","primary",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"mat-card",0)(1,"div",1),t._uU(2," Online translation settings. You have to reload page after change. "),t.qZA(),t.TgZ(3,"div",2)(4,"mat-form-field",3)(5,"mat-label"),t._uU(6,"Translation Url"),t.qZA(),t.TgZ(7,"input",4),t.NdJ("ngModelChange",function(u){return e.url=u}),t.qZA()()(),t.TgZ(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),t._uU(11,"Language From"),t.qZA(),t.TgZ(12,"input",4),t.NdJ("ngModelChange",function(u){return e.from=u}),t.qZA()(),t.TgZ(13,"mat-form-field",6)(14,"mat-label"),t._uU(15,"Language To"),t.qZA(),t.TgZ(16,"input",4),t.NdJ("ngModelChange",function(u){return e.to=u}),t.qZA()()(),t.TgZ(17,"button",7),t.NdJ("click",function(){return e.save()}),t._uU(18," Save "),t.qZA(),t.TgZ(19,"div",8),t._uU(20),t.qZA(),t.TgZ(21,"button",9),t.NdJ("click",function(){return e.test()}),t._uU(22," Test "),t.qZA()()),2&o&&(t.xp6(7),t.Q6J("ngModel",e.url),t.xp6(5),t.Q6J("ngModel",e.from),t.xp6(4),t.Q6J("ngModel",e.to),t.xp6(1),t.Q6J("disabled",!e.url||!e.to||!e.from),t.xp6(3),t.AsE("",e.testOriginal," => ",e.testTranslation,""))},dependencies:[i.ez,h.ot,h.lW,v.QW,v.a8,f.u5,f.Fj,f.JJ,f.Q7,f.On,y.lN,y.KE,y.hX,x.c,x.Nt],styles:[".main-card[_ngcontent-%COMP%]{padding:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}.url-input[_ngcontent-%COMP%]{min-width:400px;width:100%}.langs[_ngcontent-%COMP%]{display:flex;gap:var(--padding-main)}.test-result[_ngcontent-%COMP%]{width:100%;text-align:center}"],changeDetection:0}),p})();var Z=r(5152);let w=(()=>{class p{constructor(o,e){this.customStylesService=o,this.localStorageService=e,this.copyToClipboardState=this.localStorageService.copyToClipboard,this.showDictionaryState=this.localStorageService.showDictionary,this.showTranslationState=this.localStorageService.showTranslationInBook}copyToClipboard(o){this.localStorageService.copyToClipboard=o,this.copyToClipboardState=o}showDictionary(o){this.localStorageService.showDictionary=o,this.showDictionaryState=o}showTranslation(o){this.localStorageService.showTranslationInBook=o,this.showTranslationState=o}}return p.\u0275fac=function(o){return new(o||p)(t.Y36(Z.N),t.Y36(O.n))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-settings"]],standalone:!0,features:[t.jDz],decls:27,vars:3,consts:[[1,"component-content"],[1,"header"],["mat-button","","color","primary","routerLink","/"],[1,"title"],[1,"settings"],[1,"divider"],[1,"setting-item"],["mat-button","","color","primary",3,"click"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._uU(3," Go Home. "),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Settings"),t.qZA()(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return e.customStylesService.resetAllStyles()}),t._uU(10," Reset all styles "),t.qZA()(),t._UZ(11,"div",5),t.TgZ(12,"div",6)(13,"button",7),t.NdJ("click",function(){return e.copyToClipboard(!e.copyToClipboardState)}),t._uU(14),t.qZA()(),t._UZ(15,"div",5),t.TgZ(16,"div",6)(17,"button",7),t.NdJ("click",function(){return e.showDictionary(!e.showDictionaryState)}),t._uU(18),t.qZA()(),t._UZ(19,"div",5),t.TgZ(20,"div",6)(21,"button",7),t.NdJ("click",function(){return e.showTranslation(!e.showTranslationState)}),t._uU(22),t.qZA()(),t._UZ(23,"div",5)(24,"app-translator-settings")(25,"app-import-dictionary")(26,"app-import-favorite-example"),t.qZA()()),2&o&&(t.xp6(14),t.hij(" Copy to clipboard: ",e.copyToClipboardState," "),t.xp6(4),t.hij(" Show dictionary: ",e.showDictionaryState," "),t.xp6(4),t.hij(" Show Translation: ",e.showTranslationState," "))},dependencies:[i.ez,h.ot,h.lW,M.rH,n,m,P],styles:[".component-content[_ngcontent-%COMP%]{padding:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.component-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%;min-width:100%;border-top:1px dashed gray;margin:var(--padding-main) 0}.component-content[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]{justify-content:center;display:flex}"]}),p})()},2875:(D,C,r)=>{r.d(C,{n:()=>_});var i=function(d){return d.CurrentPopupMenuTab="CurrentPopupMenuTab",d.CopyToClipboard="CopyToClipboard",d.ShowDictionary="ShowDictionary",d.HideMarkedHeaders="HideMarkedHeaders",d.ShowTranslationInBook="ShowTranslationInBook",d.AutoTranslateSelected="AutoTranslateSelected",d.ShowTranslatorInDictionaryViewer="ShowTranslatorInDictionaryViewer",d.TranslationUrl="TranslationUrl",d.TranslationFrom="TranslationFrom",d.TranslationTo="TranslationTo",d}(i||{}),v=r(5879);let _=(()=>{class d{get hideMarkedHeaders(){return this.getBoolean(i.HideMarkedHeaders,!1)}set hideMarkedHeaders(n){this.setBoolean(i.HideMarkedHeaders,n)}get copyToClipboard(){return this.getBoolean(i.CopyToClipboard,!0)}set copyToClipboard(n){this.setBoolean(i.CopyToClipboard,n)}get showDictionary(){return this.getBoolean(i.ShowDictionary,!1)}set showDictionary(n){this.setBoolean(i.ShowDictionary,n)}get showTranslationInBook(){return this.getBoolean(i.ShowTranslationInBook,!1)}set showTranslationInBook(n){this.setBoolean(i.ShowTranslationInBook,n)}get showTranslatorInDictionaryViewer(){return this.getBoolean(i.ShowTranslatorInDictionaryViewer,!1)}set showTranslatorInDictionaryViewer(n){this.setBoolean(i.ShowTranslatorInDictionaryViewer,n)}get autoTranslateSelected(){return this.getBoolean(i.AutoTranslateSelected,!1)}set autoTranslateSelected(n){this.setBoolean(i.AutoTranslateSelected,n)}get currentPopupMenuTab(){return this.getNumber(i.CurrentPopupMenuTab)}set currentPopupMenuTab(n){this.setNumber(i.CurrentPopupMenuTab,n||0)}get translationUrl(){return this.getString(i.TranslationUrl,"http://127.0.0.1:3000/translate")}set translationUrl(n){this.setString(i.TranslationUrl,n)}get translationFrom(){return this.getString(i.TranslationFrom,"en")}set translationFrom(n){this.setString(i.TranslationFrom,n)}get translationTo(){return this.getString(i.TranslationTo,"ru")}set translationTo(n){this.setString(i.TranslationTo,n)}constructor(){this.trueString="true",this.falseString="false"}getString(n,g=""){return localStorage.getItem(n)||g}setString(n,g){localStorage.setItem(n,g)}setNumber(n,g){localStorage.setItem(n,String(g||0))}getNumber(n,g=0){const a=localStorage.getItem(n);if(null===a)return g;const l=+a;return Number.isNaN(l)?g:l}setBoolean(n,g){localStorage.setItem(n,g?this.trueString:this.falseString)}getBoolean(n,g=!1){const a=localStorage.getItem(n);return a===this.trueString||a!==this.falseString&&g}}return d.\u0275fac=function(n){return new(n||d)},d.\u0275prov=v.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},3890:(D,C,r)=>{r.d(C,{Q:()=>n});var i=r(5619),h=r(8180),M=r(4716),t=r(5879),v=r(9862),_=r(2875),d=r(957),b=r(1839);let n=(()=>{class g{constructor(l,m,f,y){this.http=l,this.localStorageService=m,this.info=f,this.loader=y,this.current$=new i.X(null),this.autoTranslateSelected$=new i.X(this.localStorageService.autoTranslateSelected),this.url=this.localStorageService.translationUrl,this.from=this.localStorageService.translationFrom,this.to=this.localStorageService.translationTo}getTranslation(l){return this.http.post(this.url,{text:l,from:this.from,to:this.to})}switchAutoTranslate(){const l=!this.autoTranslateSelected$.value;this.autoTranslateSelected$.next(l),this.localStorageService.autoTranslateSelected=l}getCurrentTranslation(l,m=!1){if(!l||!m&&!this.autoTranslateSelected$.value)return;const f={text:l,from:this.from,to:this.to};this.loader.topOn(),this.http.post(this.url,f).pipe((0,h.q)(1),(0,M.x)(()=>this.loader.topOff())).subscribe({next:y=>{this.current$.next(y)},error:y=>{console.error(y),this.info.error(y.message||"Some error")}})}}return g.\u0275fac=function(l){return new(l||g)(t.LFG(v.eN),t.LFG(_.n),t.LFG(d.C),t.LFG(b.D))},g.\u0275prov=t.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()}}]);