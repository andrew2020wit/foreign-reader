import{p as v}from"./chunk-EDACHHSA.js";import{D as o,U as d,Y as p,a as l,b as c,h,ic as a,kc as u,l as f}from"./chunk-OUFBJRPP.js";var w=(()=>{class m{constructor(t,i){this.dbService=t,this.infoService=i,this.examples$=new h([]),this.sort=(e,s)=>(e.toDoTimestamp||0)-(s.toDoTimestamp||0),this.dbService.getAll(a.FavoriteExamples).pipe(o(1)).subscribe(e=>{e.forEach(s=>s.showDetails=!1),e?(e.sort(this.sort),this.examples$.next(e)):this.examples$.next([])})}deleteAll(){return this.dbService.clear(a.FavoriteExamples)}import(t){let i=JSON.parse(t)?.favoriteExamples;if(!i?.length)return console.error("!examples?.length"),this.infoService.error("!examples?.length"),f([]);let e=this.examples$.value.map(r=>r.timestamp);function s(r){return e.includes(r)?s(r+1):r}return i.forEach(r=>{if(!r.timestamp){let n=s(Date.now());e.push(n),r.timestamp=n}}),this.dbService.bulkAdd(a.FavoriteExamples,i).pipe(o(1))}addExample(t){let i=Date.now(),e=c(l({},t),{timestamp:i,showDetails:!1});this.dbService.add(a.FavoriteExamples,e).pipe(o(1)).subscribe();let s=[e,...this.examples$.value];this.examples$.next(s),this.infoService.show("added: "+t.original)}update(t){if(!t?.timestamp||!t.toDoTimestamp)return;let i=this.examples$.value,e=i.find(s=>s.timestamp===t.timestamp);e&&(e.toDoTimestamp=t.toDoTimestamp,e.updateTimestamp=Date.now(),this.dbService.update(a.FavoriteExamples,e).pipe(o(1)).subscribe(),i.sort(this.sort),this.examples$.next(i))}removeExample(t){if(!t)return;this.dbService.delete(a.FavoriteExamples,t).pipe(o(1)).subscribe();let i=this.examples$.value.filter(e=>e.timestamp!==t);this.examples$.next(i)}static{this.\u0275fac=function(i){return new(i||m)(p(u),p(v))}}static{this.\u0275prov=d({token:m,factory:m.\u0275fac,providedIn:"root"})}}return m})();export{w as a};
