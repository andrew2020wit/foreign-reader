"use strict";(self.webpackChunkforeign_reader=self.webpackChunkforeign_reader||[]).push([[278],{5709:(D,C,o)=>{o.d(C,{j:()=>f});var i=o(5619),m=o(8180),b=o(2096),t=o(7772),s=o(5879),S=o(2e3),r=o(957);let f=(()=>{class g{constructor(h,p){this.dbService=h,this.infoService=p,this.examples$=new i.X([]),this.sort=(u,v)=>(u.toDoTimestamp||0)-(v.toDoTimestamp||0),this.dbService.getAll(t.L6.FavoriteExamples).pipe((0,m.q)(1)).subscribe(u=>{u.forEach(v=>v.showDetails=!1),u?(u.sort(this.sort),this.examples$.next(u)):this.examples$.next([])})}deleteAll(){return this.dbService.clear(t.L6.FavoriteExamples)}import(h){const p=JSON.parse(h)?.favoriteExamples;return p?.length?this.dbService.bulkAdd(t.L6.FavoriteExamples,p).pipe((0,m.q)(1)):(console.error("!examples?.length"),this.infoService.error("!examples?.length"),(0,b.of)([]))}addExample(h){const p=Date.now(),u={...h,timestamp:p,showDetails:!1};this.dbService.add(t.L6.FavoriteExamples,u).pipe((0,m.q)(1)).subscribe();const v=[u,...this.examples$.value];this.examples$.next(v),this.infoService.show("added: "+h.original)}update(h){if(!h?.timestamp||!h.toDoTimestamp)return;const p=this.examples$.value,u=p.find(v=>v.timestamp===h.timestamp);u&&(u.toDoTimestamp=h.toDoTimestamp,u.updateTimestamp=Date.now(),this.dbService.update(t.L6.FavoriteExamples,u).pipe((0,m.q)(1)).subscribe(),p.sort(this.sort),this.examples$.next(p))}removeExample(h){if(!h)return;this.dbService.delete(t.L6.FavoriteExamples,h).pipe((0,m.q)(1)).subscribe();const p=this.examples$.value.filter(u=>u.timestamp!==h);this.examples$.next(p)}}return g.\u0275fac=function(h){return new(h||g)(s.LFG(S.ys),s.LFG(r.C))},g.\u0275prov=s.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},2278:(D,C,o)=>{o.r(C),o.d(C,{SettingsComponent:()=>U});var i=o(6814),m=o(2296),b=o(4408),t=o(5879),s=o(5195),S=o(8180),r=o(1839),f=o(144);let g=(()=>{class c{constructor(n,e){this.loader=n,this.exportImportService=e,this.update=new t.vpe}readMorphologyReplaceRules(n){const e=n?.target?.files[0];if(!e)return;const a=new FileReader;a.onload=d=>{const l=d?.target?.result;if(!l)return;const y=this.exportImportService.importMorphologyReplaceRules(l);y&&(this.loader.start(),y.pipe((0,S.q)(1)).subscribe(()=>{this.loader.stop()}))},a.readAsText(e)}readMorphology(n){const e=n?.target?.files[0];if(!e)return;const a=new FileReader;a.onload=d=>{const l=d?.target?.result;if(!l)return;const y=this.exportImportService.importMorphology(l);y&&(this.loader.start(),y.pipe((0,S.q)(1)).subscribe(()=>{this.loader.stop()}))},a.readAsText(e)}readDictionary(n){const e=n?.target?.files[0];if(!e)return;const a=new FileReader;a.onload=d=>{const l=d?.target?.result;if(!l)return;const y=this.exportImportService.importDictionary(l);y&&(this.loader.start(),y.pipe((0,S.q)(1)).subscribe(()=>{this.loader.stop()}))},a.readAsText(e)}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(r.D),t.Y36(f.U))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-import-dictionary"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:18,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["morphologyFileInput",""],["morphologyReplaceRulesFileInput",""],["dictionaryFileInput",""]],template:function(n,e){if(1&n){const a=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," It can take a few minutes to import a large dictionary. You'll have to wait. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){t.CHM(a);const l=t.MAs(13);return t.KtG(l.click())}),t._uU(5," Import (replace) morphology "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(a);const l=t.MAs(15);return t.KtG(l.click())}),t._uU(7," Import (replace) MorphologyReplaceRules "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){t.CHM(a);const l=t.MAs(17);return t.KtG(l.click())}),t._uU(9," Import (replace) dictionary "),t.qZA()(),t.TgZ(10,"div",0),t._uU(11," You have to reload web-application to apply new morphology and/or new dictionary. "),t.qZA()(),t.TgZ(12,"input",3,4),t.NdJ("change",function(l){return e.readMorphology(l)}),t.qZA(),t.TgZ(14,"input",3,5),t.NdJ("change",function(l){return e.readMorphologyReplaceRules(l)}),t.qZA(),t.TgZ(16,"input",3,6),t.NdJ("change",function(l){return e.readDictionary(l)}),t.qZA()}},dependencies:[i.ez,m.ot,m.lW,s.QW,s.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main);margin-top:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),c})();var p=o(5709);let u=(()=>{class c{constructor(n,e){this.loader=n,this.favoriteExamplesService=e,this.update=new t.vpe,this.datePipe=new i.uU("en")}export(){const n=this.favoriteExamplesService.examples$.value;n?.length&&this.download(function h(c){return JSON.stringify(c,null,2)}({favoriteExamples:n}),"favorite-examples")}import(n){const e=n?.target?.files[0];if(!e)return;const a=new FileReader;a.onload=d=>{const l=d?.target?.result;if(!l)return;const y=this.favoriteExamplesService.import(l);y&&(this.loader.start(),y.pipe((0,S.q)(1)).subscribe(F=>{this.loader.stop()}))},a.readAsText(e)}deleteAll(){window.confirm("Delete all?")&&(this.loader.start(),this.favoriteExamplesService.deleteAll().pipe((0,S.q)(1)).subscribe(e=>{this.loader.stop()}))}download(n,e){!function T(c,_){const e=document.createElement("a"),a=new Blob([c],{type:"text/plain"});e.href=URL.createObjectURL(a),e.download=_,e.click(),e.remove()}(n,e+`.${this.datePipe.transform(new Date,"yyyy-MM-dd")}.json`)}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(r.D),t.Y36(p.j))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-import-favorite-example"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:12,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["importFileInput",""]],template:function(n,e){if(1&n){const a=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," Favorite examples. You have to reload page after import. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){return e.export()}),t._uU(5," Export Favorites "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(a);const l=t.MAs(11);return t.KtG(l.click())}),t._uU(7," Import (add) Favorites "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return e.deleteAll()}),t._uU(9," Delete all Favorites "),t.qZA()()(),t.TgZ(10,"input",3,4),t.NdJ("change",function(l){return e.import(l)}),t.qZA()}},dependencies:[i.ez,m.ot,m.lW,s.QW,s.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),c})();var v=o(6223),M=o(9157),O=o(2032),I=o(4716),x=o(2439),Z=o(3890),A=o(957),E=o(2969);let P=(()=>{class c{constructor(n,e,a,d,l){this.loader=n,this.translatorService=e,this.info=a,this.cdr=d,this.localStorageService=l,this.testOriginal="Hello world!",this.testTranslation="",this.url="",this.from="",this.to="",this.url=this.localStorageService.translationUrl,this.from=this.localStorageService.translationFrom,this.to=this.localStorageService.translationTo}setDefault(){this.url=x.m_,this.from=x.fT,this.to=x.Nz,this.save()}test(){this.loader.topOn(),this.translatorService.getTranslation(this.testOriginal).pipe((0,S.q)(1),(0,I.x)(()=>this.loader.topOff())).subscribe({next:n=>{this.testTranslation=n.translation,this.cdr.detectChanges()},error:n=>{console.error(n),this.info.error(n.message||"Some error")}})}save(){!this.url||!this.from||!this.to||(this.localStorageService.translationUrl=this.url,this.localStorageService.translationFrom=this.from,this.localStorageService.translationTo=this.to)}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(r.D),t.Y36(Z.Q),t.Y36(A.C),t.Y36(t.sBO),t.Y36(E.n))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-translator-settings"]],standalone:!0,features:[t.jDz],decls:28,vars:6,consts:[[1,"main-card"],[1,"info"],[1,"url"],["appearance","outline",1,"url-input"],["matInput","","required","",3,"ngModel","ngModelChange"],[1,"langs"],["appearance","outline",1,"input"],["mat-button","","color","primary",3,"disabled","click"],["mat-button","","color","primary",3,"click"],[1,"test-result"]],template:function(n,e){1&n&&(t.TgZ(0,"mat-card",0)(1,"div",1),t._uU(2," Online translation settings. You have "),t.TgZ(3,"strong"),t._uU(4,"to reload page "),t.qZA(),t._uU(5," after change. "),t.qZA(),t.TgZ(6,"div",2)(7,"mat-form-field",3)(8,"mat-label"),t._uU(9,"Translation Url"),t.qZA(),t.TgZ(10,"input",4),t.NdJ("ngModelChange",function(d){return e.url=d}),t.qZA()()(),t.TgZ(11,"div",5)(12,"mat-form-field",6)(13,"mat-label"),t._uU(14,"Language From"),t.qZA(),t.TgZ(15,"input",4),t.NdJ("ngModelChange",function(d){return e.from=d}),t.qZA()(),t.TgZ(16,"mat-form-field",6)(17,"mat-label"),t._uU(18,"Language To"),t.qZA(),t.TgZ(19,"input",4),t.NdJ("ngModelChange",function(d){return e.to=d}),t.qZA()()(),t.TgZ(20,"button",7),t.NdJ("click",function(){return e.save()}),t._uU(21," Save "),t.qZA(),t.TgZ(22,"button",8),t.NdJ("click",function(){return e.setDefault()}),t._uU(23," setDefault "),t.qZA(),t.TgZ(24,"div",9),t._uU(25),t.qZA(),t.TgZ(26,"button",8),t.NdJ("click",function(){return e.test()}),t._uU(27," Test "),t.qZA()()),2&n&&(t.xp6(10),t.Q6J("ngModel",e.url),t.xp6(5),t.Q6J("ngModel",e.from),t.xp6(4),t.Q6J("ngModel",e.to),t.xp6(1),t.Q6J("disabled",!e.url||!e.to||!e.from),t.xp6(5),t.AsE("",e.testOriginal," => ",e.testTranslation,""))},dependencies:[i.ez,m.ot,m.lW,s.QW,s.a8,v.u5,v.Fj,v.JJ,v.Q7,v.On,M.lN,M.KE,M.hX,O.c,O.Nt],styles:[".main-card[_ngcontent-%COMP%]{padding:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}.url-input[_ngcontent-%COMP%]{min-width:400px;width:100%}.langs[_ngcontent-%COMP%]{display:flex;gap:var(--padding-main)}.test-result[_ngcontent-%COMP%]{width:100%;text-align:center}"],changeDetection:0}),c})();var w=o(5152);let U=(()=>{class c{constructor(n,e){this.customStylesService=n,this.localStorageService=e,this.copyToClipboardState=this.localStorageService.copyToClipboard,this.showDictionaryState=this.localStorageService.showDictionary,this.showTranslationState=this.localStorageService.showTranslationInBook}copyToClipboard(n){this.localStorageService.copyToClipboard=n,this.copyToClipboardState=n}showDictionary(n){this.localStorageService.showDictionary=n,this.showDictionaryState=n}showTranslation(n){this.localStorageService.showTranslationInBook=n,this.showTranslationState=n}}return c.\u0275fac=function(n){return new(n||c)(t.Y36(w.N),t.Y36(E.n))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-settings"]],standalone:!0,features:[t.jDz],decls:27,vars:3,consts:[[1,"component-content"],[1,"header"],["mat-button","","color","primary","routerLink","/"],[1,"title"],[1,"settings"],[1,"divider"],[1,"setting-item"],["mat-button","","color","primary",3,"click"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._uU(3," Go Home. "),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Settings"),t.qZA()(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return e.customStylesService.resetAllStyles()}),t._uU(10," Reset all styles "),t.qZA()(),t._UZ(11,"div",5),t.TgZ(12,"div",6)(13,"button",7),t.NdJ("click",function(){return e.copyToClipboard(!e.copyToClipboardState)}),t._uU(14),t.qZA()(),t._UZ(15,"div",5),t.TgZ(16,"div",6)(17,"button",7),t.NdJ("click",function(){return e.showDictionary(!e.showDictionaryState)}),t._uU(18),t.qZA()(),t._UZ(19,"div",5),t.TgZ(20,"div",6)(21,"button",7),t.NdJ("click",function(){return e.showTranslation(!e.showTranslationState)}),t._uU(22),t.qZA()(),t._UZ(23,"div",5)(24,"app-translator-settings")(25,"app-import-dictionary")(26,"app-import-favorite-example"),t.qZA()()),2&n&&(t.xp6(14),t.hij(" Copy to clipboard: ",e.copyToClipboardState," "),t.xp6(4),t.hij(" Show dictionary: ",e.showDictionaryState," "),t.xp6(4),t.hij(" Show Translation: ",e.showTranslationState," "))},dependencies:[i.ez,m.ot,m.lW,b.rH,g,u,P],styles:[".component-content[_ngcontent-%COMP%]{padding:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.component-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%;min-width:100%;border-top:1px dashed gray;margin:var(--padding-main) 0}.component-content[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]{justify-content:center;display:flex}"]}),c})()},2969:(D,C,o)=>{o.d(C,{n:()=>t});var i=function(s){return s.CurrentPopupMenuTab="CurrentPopupMenuTab",s.CopyToClipboard="CopyToClipboard",s.ShowDictionary="ShowDictionary",s.HideMarkedHeaders="HideMarkedHeaders",s.ShowTranslationInBook="ShowTranslationInBook",s.AutoTranslateSelected="AutoTranslateSelected",s.ShowTranslatorInDictionaryViewer="ShowTranslatorInDictionaryViewer",s.TranslationUrl="TranslationUrl",s.TranslationFrom="TranslationFrom",s.TranslationTo="TranslationTo",s}(i||{}),m=o(2439),b=o(5879);let t=(()=>{class s{get hideMarkedHeaders(){return this.getBoolean(i.HideMarkedHeaders,!1)}set hideMarkedHeaders(r){this.setBoolean(i.HideMarkedHeaders,r)}get copyToClipboard(){return this.getBoolean(i.CopyToClipboard,!0)}set copyToClipboard(r){this.setBoolean(i.CopyToClipboard,r)}get showDictionary(){return this.getBoolean(i.ShowDictionary,!1)}set showDictionary(r){this.setBoolean(i.ShowDictionary,r)}get showTranslationInBook(){return this.getBoolean(i.ShowTranslationInBook,!1)}set showTranslationInBook(r){this.setBoolean(i.ShowTranslationInBook,r)}get showTranslatorInDictionaryViewer(){return this.getBoolean(i.ShowTranslatorInDictionaryViewer,!1)}set showTranslatorInDictionaryViewer(r){this.setBoolean(i.ShowTranslatorInDictionaryViewer,r)}get autoTranslateSelected(){return this.getBoolean(i.AutoTranslateSelected,!1)}set autoTranslateSelected(r){this.setBoolean(i.AutoTranslateSelected,r)}get currentPopupMenuTab(){return this.getNumber(i.CurrentPopupMenuTab)}set currentPopupMenuTab(r){this.setNumber(i.CurrentPopupMenuTab,r||0)}get translationUrl(){return this.getString(i.TranslationUrl,m.m_)}set translationUrl(r){this.setString(i.TranslationUrl,r)}get translationFrom(){return this.getString(i.TranslationFrom,m.fT)}set translationFrom(r){this.setString(i.TranslationFrom,r)}get translationTo(){return this.getString(i.TranslationTo,m.Nz)}set translationTo(r){this.setString(i.TranslationTo,r)}constructor(){this.trueString="true",this.falseString="false"}getString(r,f=""){return localStorage.getItem(r)||f}setString(r,f){localStorage.setItem(r,f)}setNumber(r,f){localStorage.setItem(r,String(f||0))}getNumber(r,f=0){const g=localStorage.getItem(r);if(null===g)return f;const T=+g;return Number.isNaN(T)?f:T}setBoolean(r,f){localStorage.setItem(r,f?this.trueString:this.falseString)}getBoolean(r,f=!1){const g=localStorage.getItem(r);return g===this.trueString||g!==this.falseString&&f}}return s.\u0275fac=function(r){return new(r||s)},s.\u0275prov=b.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},2439:(D,C,o)=>{o.d(C,{Nz:()=>b,fT:()=>m,m_:()=>i});const i="http://127.0.0.1:3007/translate",m="en",b="ru"},3890:(D,C,o)=>{o.d(C,{Q:()=>g});var i=o(5619),m=o(8180),b=o(4716),t=o(5879),s=o(9862),S=o(2969),r=o(957),f=o(1839);let g=(()=>{class T{constructor(p,u,v,M){this.http=p,this.localStorageService=u,this.info=v,this.loader=M,this.current$=new i.X(null),this.autoTranslateSelected$=new i.X(this.localStorageService.autoTranslateSelected),this.url=this.localStorageService.translationUrl,this.from=this.localStorageService.translationFrom,this.to=this.localStorageService.translationTo}getTranslation(p){return this.http.post(this.url,{text:p,from:this.from,to:this.to})}switchAutoTranslate(){const p=!this.autoTranslateSelected$.value;this.autoTranslateSelected$.next(p),this.localStorageService.autoTranslateSelected=p}getCurrentTranslation(p,u=!1){if(!p||!u&&!this.autoTranslateSelected$.value)return;const v={text:p,from:this.from,to:this.to};this.loader.topOn(),this.http.post(this.url,v).pipe((0,m.q)(1),(0,b.x)(()=>this.loader.topOff())).subscribe({next:M=>{this.current$.next(M)},error:M=>{console.error(M),this.info.error(M.message||"Some error")}})}}return T.\u0275fac=function(p){return new(p||T)(t.LFG(s.eN),t.LFG(S.n),t.LFG(r.C),t.LFG(f.D))},T.\u0275prov=t.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()}}]);