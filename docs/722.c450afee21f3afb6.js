"use strict";(self.webpackChunkforeign_reader=self.webpackChunkforeign_reader||[]).push([[722],{1177:(F,k,c)=>{c.d(k,{LH:()=>e,Ot:()=>v,Zt:()=>h,jk:()=>r});const r="http://127.0.0.1:8765",v=500,e="ankiTag",h="ankiRequestText"},7251:(F,k,c)=>{c.d(k,{f:()=>p});var r=c(4412),v=c(6697),e=c(7673),h=c(9040),f=c(4438),_=c(9456),C=c(9530);let p=(()=>{class b{constructor(l,d){this.dbService=l,this.infoService=d,this.examples$=new r.t([]),this.sort=(m,S)=>(m.toDoTimestamp||0)-(S.toDoTimestamp||0),this.dbService.getAll(h.Y.FavoriteExamples).pipe((0,v.s)(1)).subscribe(m=>{m.forEach(S=>S.showDetails=!1),m?(m.sort(this.sort),this.examples$.next(m)):this.examples$.next([])})}deleteAll(){return this.dbService.clear(h.Y.FavoriteExamples)}import(l){const d=JSON.parse(l)?.favoriteExamples;if(!d?.length)return console.error("!examples?.length"),this.infoService.error("!examples?.length"),(0,e.of)([]);const m=this.examples$.value.map(y=>y.timestamp);function S(y){return m.includes(y)?S(y+1):y}return d.forEach(y=>{if(!y.timestamp){const I=S(Date.now());m.push(I),y.timestamp=I}}),this.dbService.bulkAdd(h.Y.FavoriteExamples,d).pipe((0,v.s)(1))}addExample(l){const d=Date.now(),m={...l,timestamp:d,showDetails:!1};this.dbService.add(h.Y.FavoriteExamples,m).pipe((0,v.s)(1)).subscribe();const S=[m,...this.examples$.value];this.examples$.next(S),this.infoService.show("added: "+l.original)}update(l){if(!l?.timestamp||!l.toDoTimestamp)return;const d=this.examples$.value,m=d.find(S=>S.timestamp===l.timestamp);m&&(m.toDoTimestamp=l.toDoTimestamp,m.updateTimestamp=Date.now(),this.dbService.update(h.Y.FavoriteExamples,m).pipe((0,v.s)(1)).subscribe(),d.sort(this.sort),this.examples$.next(d))}removeExample(l){if(!l)return;this.dbService.delete(h.Y.FavoriteExamples,l).pipe((0,v.s)(1)).subscribe();const d=this.examples$.value.filter(m=>m.timestamp!==l);this.examples$.next(d)}static{this.\u0275fac=function(d){return new(d||b)(f.KVO(_.MX),f.KVO(C.O))}}static{this.\u0275prov=f.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}}return b})()},3722:(F,k,c)=>{c.r(k),c.d(k,{SettingsComponent:()=>M});var r=c(8834),v=c(4710),e=c(4438),h=c(5596),f=c(6697),_=c(7749),C=c(7118);let p=(()=>{class g{constructor(i,s){this.loader=i,this.exportImportService=s,this.update=new e.bkB}readMorphologyReplaceRules(i){const s=i?.target?.files[0];if(!s)return;const t=new FileReader;t.onload=a=>{const o=a?.target?.result;if(!o)return;const u=this.exportImportService.importMorphologyReplaceRules(o);u&&(this.loader.start(),u.pipe((0,f.s)(1)).subscribe(()=>{this.loader.stop()}))},t.readAsText(s)}readMorphology(i){const s=i?.target?.files[0];if(!s)return;const t=new FileReader;t.onload=a=>{const o=a?.target?.result;if(!o)return;const u=this.exportImportService.importMorphology(o);u&&(this.loader.start(),u.pipe((0,f.s)(1)).subscribe(()=>{this.loader.stop()}))},t.readAsText(s)}readDictionary(i){const s=i?.target?.files[0];if(!s)return;const t=new FileReader;t.onload=a=>{const o=a?.target?.result;if(!o)return;const u=this.exportImportService.importDictionary(o);u&&(this.loader.start(),u.pipe((0,f.s)(1)).subscribe(()=>{this.loader.stop()}))},t.readAsText(s)}static{this.\u0275fac=function(s){return new(s||g)(e.rXU(_.Z),e.rXU(C.p))}}static{this.\u0275cmp=e.VBU({type:g,selectors:[["app-import-dictionary"]],outputs:{update:"update"},standalone:!0,features:[e.aNF],decls:18,vars:0,consts:[["morphologyFileInput",""],["morphologyReplaceRulesFileInput",""],["dictionaryFileInput",""],[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"]],template:function(s,t){if(1&s){const a=e.RV6();e.j41(0,"mat-card")(1,"div",3),e.EFF(2," It can take a few minutes to import a large dictionary. You'll have to wait. "),e.k0s(),e.j41(3,"div",4)(4,"button",5),e.bIt("click",function(){e.eBV(a);const u=e.sdS(13);return e.Njj(u.click())}),e.EFF(5," Import (replace) morphology "),e.k0s(),e.j41(6,"button",5),e.bIt("click",function(){e.eBV(a);const u=e.sdS(15);return e.Njj(u.click())}),e.EFF(7," Import (replace) MorphologyReplaceRules "),e.k0s(),e.j41(8,"button",5),e.bIt("click",function(){e.eBV(a);const u=e.sdS(17);return e.Njj(u.click())}),e.EFF(9," Import (replace) dictionary "),e.k0s()(),e.j41(10,"div",3),e.EFF(11," You have to reload to apply the morphology and/or the dictionary. "),e.k0s()(),e.j41(12,"input",6,0),e.bIt("change",function(u){return e.eBV(a),e.Njj(t.readMorphology(u))}),e.k0s(),e.j41(14,"input",6,1),e.bIt("change",function(u){return e.eBV(a),e.Njj(t.readMorphologyReplaceRules(u))}),e.k0s(),e.j41(16,"input",6,2),e.bIt("change",function(u){return e.eBV(a),e.Njj(t.readDictionary(u))}),e.k0s()}},dependencies:[r.Hl,r.$z,h.Hu,h.RN],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main);margin-top:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0})}}return g})();var b=c(177),n=c(192),d=c(7251);let m=(()=>{class g{constructor(i,s){this.loader=i,this.favoriteExamplesService=s,this.update=new e.bkB,this.datePipe=new b.vh("en")}export(){const i=this.favoriteExamplesService.examples$.value;i?.length&&this.download(function l(g){return JSON.stringify(g,null,2)}({favoriteExamples:i}),"favorite-examples")}import(i){const s=i?.target?.files[0];if(!s)return;const t=new FileReader;t.onload=a=>{const o=a?.target?.result;if(!o)return;const u=this.favoriteExamplesService.import(o);u&&(this.loader.start(),u.pipe((0,f.s)(1)).subscribe(E=>{this.loader.stop()}))},t.readAsText(s)}deleteAll(){window.confirm("Delete all?")&&(this.loader.start(),this.favoriteExamplesService.deleteAll().pipe((0,f.s)(1)).subscribe(s=>{this.loader.stop()}))}download(i,s){const t=this.datePipe.transform(new Date,"yyyy-MM-dd");(0,n.V)(i,s+`.${t}.json`)}static{this.\u0275fac=function(s){return new(s||g)(e.rXU(_.Z),e.rXU(d.f))}}static{this.\u0275cmp=e.VBU({type:g,selectors:[["app-import-favorite-example"]],outputs:{update:"update"},standalone:!0,features:[e.aNF],decls:12,vars:0,consts:[["importFileInput",""],[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"]],template:function(s,t){if(1&s){const a=e.RV6();e.j41(0,"mat-card")(1,"div",1),e.EFF(2," Favorite examples. You have to reload the page after import. "),e.k0s(),e.j41(3,"div",2)(4,"button",3),e.bIt("click",function(){return e.eBV(a),e.Njj(t.export())}),e.EFF(5," Export Favorites "),e.k0s(),e.j41(6,"button",3),e.bIt("click",function(){e.eBV(a);const u=e.sdS(11);return e.Njj(u.click())}),e.EFF(7," Import (add) Favorites "),e.k0s(),e.j41(8,"button",3),e.bIt("click",function(){return e.eBV(a),e.Njj(t.deleteAll())}),e.EFF(9," Delete all Favorites "),e.k0s()()(),e.j41(10,"input",4,0),e.bIt("change",function(u){return e.eBV(a),e.Njj(t.import(u))}),e.k0s()}},dependencies:[r.Hl,r.$z,h.Hu,h.RN],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0})}}return g})();var S=c(882),y=c(9631),I=c(9417),T=c(5643),D=c(1502);let M=(()=>{class g{constructor(i,s){this.customStylesService=i,this.localStorageService=s,this.copyToClipboardState=this.localStorageService.copyToClipboard,this.useExternalId=this.localStorageService.useExternalId,this.showDictionaryState=this.localStorageService.showDictionary,this.showTranslationState=this.localStorageService.showTranslationInBook,this.ankiHost=this.localStorageService.ankiHost,this.ankiDeck=this.localStorageService.ankiDeck,this.syncServerIsOn=this.localStorageService.syncServerIsOn,this.syncServerUrl=this.localStorageService.syncServerUrl,this.syncUserKey=this.localStorageService.syncUserKey,this.syncServerInterval=this.localStorageService.syncServerInterval}copyToClipboard(i){this.localStorageService.copyToClipboard=i,this.copyToClipboardState=i}toUseExternalId(i){this.localStorageService.useExternalId=i,this.useExternalId=i}showDictionary(i){this.localStorageService.showDictionary=i,this.showDictionaryState=i}setAnkiHost(){this.localStorageService.ankiHost=this.ankiHost}setAnkiDeck(){this.localStorageService.ankiDeck=this.ankiDeck}setSyncServerUrl(){this.syncServerUrl=this.syncServerUrl.trim(),this.localStorageService.syncServerUrl=this.syncServerUrl}setSyncUserKey(){this.syncUserKey=this.syncUserKey.trim(),this.localStorageService.syncUserKey=this.syncUserKey}setSyncServerInterval(){let i=+this.syncServerInterval;i<5&&(i=5,this.syncServerInterval=i),this.localStorageService.syncServerInterval=i}switchSyncIsOn(){this.syncServerIsOn=!this.syncServerIsOn,this.localStorageService.syncServerIsOn=this.syncServerIsOn}static{this.\u0275fac=function(s){return new(s||g)(e.rXU(T.V),e.rXU(D.s))}}static{this.\u0275cmp=e.VBU({type:g,selectors:[["app-settings"]],standalone:!0,features:[e.aNF],decls:69,vars:9,consts:[[1,"component-content"],[1,"header"],["mat-button","","color","primary","routerLink","/"],[1,"title"],[1,"settings"],[1,"divider"],[1,"setting-item"],["mat-button","","color","primary",3,"click"],[1,"text-area"],["matInput","",3,"ngModelChange","ngModel"],[1,"attention"],["matInput","","type","number",3,"ngModelChange","ngModel"]],template:function(s,t){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"button",2),e.EFF(3," Go Home. "),e.k0s(),e.j41(4,"div",3),e.EFF(5,"Settings"),e.k0s()(),e.j41(6,"div",4),e.nrm(7,"div",5),e.j41(8,"div",6)(9,"button",7),e.bIt("click",function(){return t.customStylesService.resetAllStyles()}),e.EFF(10," Reset all styles "),e.k0s()(),e.nrm(11,"div",5),e.j41(12,"div",6)(13,"button",7),e.bIt("click",function(){return t.copyToClipboard(!t.copyToClipboardState)}),e.EFF(14),e.k0s()(),e.nrm(15,"div",5),e.j41(16,"div",6)(17,"mat-form-field",8)(18,"mat-label"),e.EFF(19," ankiHost"),e.k0s(),e.j41(20,"input",9),e.mxI("ngModelChange",function(o){return e.DH7(t.ankiHost,o)||(t.ankiHost=o),o}),e.k0s()(),e.j41(21,"button",7),e.bIt("click",function(){return t.setAnkiHost()}),e.EFF(22," setAnkiHost "),e.k0s()(),e.j41(23,"div",6)(24,"mat-form-field",8)(25,"mat-label"),e.EFF(26," ankiDeck"),e.k0s(),e.j41(27,"input",9),e.mxI("ngModelChange",function(o){return e.DH7(t.ankiDeck,o)||(t.ankiDeck=o),o}),e.k0s()(),e.j41(28,"button",7),e.bIt("click",function(){return t.setAnkiDeck()}),e.EFF(29," setAnkiDeck "),e.k0s()(),e.nrm(30,"div",5),e.j41(31,"div",6)(32,"button",7),e.bIt("click",function(){return t.toUseExternalId(!t.useExternalId)}),e.EFF(33),e.k0s()(),e.nrm(34,"div",5),e.j41(35,"div",6)(36,"button",7),e.bIt("click",function(){return t.showDictionary(!t.showDictionaryState)}),e.EFF(37),e.k0s()(),e.nrm(38,"div",5)(39,"app-import-dictionary")(40,"app-import-favorite-example")(41,"div",5),e.j41(42,"div",10),e.EFF(43," You have to reload the application to apply sync changes. "),e.k0s(),e.j41(44,"div",6)(45,"mat-form-field",8)(46,"mat-label"),e.EFF(47," Synchronization Server Url"),e.k0s(),e.j41(48,"input",9),e.mxI("ngModelChange",function(o){return e.DH7(t.syncServerUrl,o)||(t.syncServerUrl=o),o}),e.k0s()(),e.j41(49,"button",7),e.bIt("click",function(){return t.setSyncServerUrl()}),e.EFF(50," set SyncServerUrl "),e.k0s()(),e.j41(51,"div",6)(52,"mat-form-field",8)(53,"mat-label"),e.EFF(54," Synchronization User Key"),e.k0s(),e.j41(55,"input",9),e.mxI("ngModelChange",function(o){return e.DH7(t.syncUserKey,o)||(t.syncUserKey=o),o}),e.k0s()(),e.j41(56,"button",7),e.bIt("click",function(){return t.setSyncUserKey()}),e.EFF(57," set User Key "),e.k0s()(),e.j41(58,"div",6)(59,"mat-form-field",8)(60,"mat-label"),e.EFF(61," SyncServerInterval, min 5 sec"),e.k0s(),e.j41(62,"input",11),e.mxI("ngModelChange",function(o){return e.DH7(t.syncServerInterval,o)||(t.syncServerInterval=o),o}),e.k0s()(),e.j41(63,"button",7),e.bIt("click",function(){return t.setSyncServerInterval()}),e.EFF(64," set SyncServerInterval "),e.k0s()(),e.j41(65,"div",6)(66,"button",7),e.bIt("click",function(){return t.switchSyncIsOn()}),e.EFF(67),e.k0s()(),e.nrm(68,"div",5),e.k0s()()),2&s&&(e.R7$(14),e.SpI(" Copy to clipboard: ",t.copyToClipboardState," "),e.R7$(6),e.R50("ngModel",t.ankiHost),e.R7$(7),e.R50("ngModel",t.ankiDeck),e.R7$(6),e.SpI(" Use ExternalId: ",t.useExternalId," "),e.R7$(4),e.SpI(" Show the dictionary: ",t.showDictionaryState," "),e.R7$(11),e.R50("ngModel",t.syncServerUrl),e.R7$(7),e.R50("ngModel",t.syncUserKey),e.R7$(7),e.R50("ngModel",t.syncServerInterval),e.R7$(5),e.SpI(" Sync is on: ",t.syncServerIsOn," "))},dependencies:[r.Hl,r.$z,v.Wk,p,m,S.RG,S.rl,S.nJ,y.fS,y.fg,I.X1,I.me,I.Q0,I.BC,I.YN,I.vS],styles:[".component-content[_ngcontent-%COMP%]{padding:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.component-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%;min-width:100%;border-top:1px dashed gray;margin:var(--padding-main) 0}.component-content[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]{justify-content:center;display:flex;gap:8px;align-items:center}.attention[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;margin:var(--padding-main) 0}"]})}}return g})()},1502:(F,k,c)=>{c.d(k,{s:()=>C});var r=function(p){return p.CurrentPopupMenuTab="CurrentPopupMenuTab",p.CopyToClipboard="CopyToClipboard",p.UseExternalId="UseExternalId",p.ShowDictionary="ShowDictionary",p.HideMarkedHeaders="HideMarkedHeaders",p.ShowTranslationInBook="ShowTranslationInBook",p.AutoTranslateSelected="AutoTranslateSelected",p.ShowTranslatorInDictionaryViewer="ShowTranslatorInDictionaryViewer",p.AudioVoiceURI="AudioVoiceURI",p.AudioVolume="AudioVolume",p.AudioRate="AudioRate",p.AnkiDeck="AnkiDeck",p.AnkiHost="AnkiHost",p.SyncServerUrl="SyncServerUrl",p.SyncServerIsOn="SyncServerIsOn",p.SyncServerInterval="SyncServerInterval",p.SyncUserKey="SyncUserKey",p}(r||{}),v=c(1177),_=c(4438);let C=(()=>{class p{get syncServerIsOn(){return this.getBoolean(r.SyncServerIsOn,!1)}set syncServerIsOn(n){this.setBoolean(r.SyncServerIsOn,n)}get syncServerUrl(){return localStorage.getItem(r.SyncServerUrl)||"http://main-pc:3003"}set syncServerUrl(n){localStorage.setItem(r.SyncServerUrl,n||"")}get syncUserKey(){return localStorage.getItem(r.SyncUserKey)||"test-user-key"}set syncUserKey(n){localStorage.setItem(r.SyncUserKey,n||"")}get syncServerInterval(){return this.getNumber(r.SyncServerInterval,5)}set syncServerInterval(n){this.setNumber(r.SyncServerInterval,0===n?0:n||5)}get ankiHost(){return localStorage.getItem(r.AnkiHost)||v.jk}set ankiHost(n){localStorage.setItem(r.AnkiHost,n||"")}get ankiDeck(){return localStorage.getItem(r.AnkiDeck)||""}set ankiDeck(n){localStorage.setItem(r.AnkiDeck,n||"")}get audioVoiceURI(){return localStorage.getItem(r.AudioVoiceURI)||""}set audioVoiceURI(n){localStorage.setItem(r.AudioVoiceURI,n||"")}get audioVolume(){return this.getNumber(r.AudioVolume,1)}set audioVolume(n){this.setNumber(r.AudioVolume,0===n?0:n||1)}get audioRate(){return this.getNumber(r.AudioRate,1)}set audioRate(n){this.setNumber(r.AudioRate,0===n?0:n||1)}get hideMarkedHeaders(){return this.getBoolean(r.HideMarkedHeaders,!1)}set hideMarkedHeaders(n){this.setBoolean(r.HideMarkedHeaders,n)}get copyToClipboard(){return this.getBoolean(r.CopyToClipboard,!1)}set copyToClipboard(n){this.setBoolean(r.CopyToClipboard,n)}get useExternalId(){return this.getBoolean(r.UseExternalId,!1)}set useExternalId(n){this.setBoolean(r.UseExternalId,n)}get showDictionary(){return this.getBoolean(r.ShowDictionary,!0)}set showDictionary(n){this.setBoolean(r.ShowDictionary,n)}get showTranslationInBook(){return this.getBoolean(r.ShowTranslationInBook,!0)}set showTranslationInBook(n){this.setBoolean(r.ShowTranslationInBook,n)}get currentPopupMenuTab(){return this.getNumber(r.CurrentPopupMenuTab)}set currentPopupMenuTab(n){this.setNumber(r.CurrentPopupMenuTab,n||0)}constructor(){this.trueString="true",this.falseString="false"}getString(n,l=""){return localStorage.getItem(n)||l}setString(n,l){localStorage.setItem(n,l)}setNumber(n,l){localStorage.setItem(n,String(l||0))}getNumber(n,l=0){const d=localStorage.getItem(n);if(null===d)return l;const m=+d;return Number.isNaN(m)?l:m}setBoolean(n,l){localStorage.setItem(n,l?this.trueString:this.falseString)}getBoolean(n,l=!1){const d=localStorage.getItem(n);return d===this.trueString||d!==this.falseString&&l}static{this.\u0275fac=function(l){return new(l||p)}}static{this.\u0275prov=_.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}}return p})()}}]);