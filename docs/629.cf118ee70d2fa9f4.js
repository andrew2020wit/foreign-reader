"use strict";(self.webpackChunkforeign_reader=self.webpackChunkforeign_reader||[]).push([[629],{2945:(I,T,i)=>{i.d(T,{KM:()=>g,N3:()=>t,s7:()=>r,wf:()=>b});const r="http://127.0.0.1:8765",g=500,b="ankiTag",t="ankiRequestText"},3631:(I,T,i)=>{i.d(T,{j:()=>h});var r=i(5619),g=i(8180),b=i(2096),t=i(7772),a=i(5879),S=i(6280),o=i(957);let h=(()=>{class d{constructor(u,f){this.dbService=u,this.infoService=f,this.examples$=new r.X([]),this.sort=(c,v)=>(c.toDoTimestamp||0)-(v.toDoTimestamp||0),this.dbService.getAll(t.L.FavoriteExamples).pipe((0,g.q)(1)).subscribe(c=>{c.forEach(v=>v.showDetails=!1),c?(c.sort(this.sort),this.examples$.next(c)):this.examples$.next([])})}deleteAll(){return this.dbService.clear(t.L.FavoriteExamples)}import(u){const f=JSON.parse(u)?.favoriteExamples;if(!f?.length)return console.error("!examples?.length"),this.infoService.error("!examples?.length"),(0,b.of)([]);const c=this.examples$.value.map(_=>_.timestamp);function v(_){return c.includes(_)?v(_+1):_}return f.forEach(_=>{if(!_.timestamp){const C=v(Date.now());c.push(C),_.timestamp=C}}),this.dbService.bulkAdd(t.L.FavoriteExamples,f).pipe((0,g.q)(1))}addExample(u){const f=Date.now(),c={...u,timestamp:f,showDetails:!1};this.dbService.add(t.L.FavoriteExamples,c).pipe((0,g.q)(1)).subscribe();const v=[c,...this.examples$.value];this.examples$.next(v),this.infoService.show("added: "+u.original)}update(u){if(!u?.timestamp||!u.toDoTimestamp)return;const f=this.examples$.value,c=f.find(v=>v.timestamp===u.timestamp);c&&(c.toDoTimestamp=u.toDoTimestamp,c.updateTimestamp=Date.now(),this.dbService.update(t.L.FavoriteExamples,c).pipe((0,g.q)(1)).subscribe(),f.sort(this.sort),this.examples$.next(f))}removeExample(u){if(!u)return;this.dbService.delete(t.L.FavoriteExamples,u).pipe((0,g.q)(1)).subscribe();const f=this.examples$.value.filter(c=>c.timestamp!==u);this.examples$.next(f)}}return d.\u0275fac=function(u){return new(u||d)(a.LFG(S.ys),a.LFG(o.C))},d.\u0275prov=a.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},3629:(I,T,i)=>{i.r(T),i.d(T,{SettingsComponent:()=>M});var r=i(6814),g=i(2296),b=i(2058),t=i(5879),a=i(5195),S=i(8180),o=i(1839),h=i(144);let d=(()=>{class m{constructor(n,e){this.loader=n,this.exportImportService=e,this.update=new t.vpe}readMorphologyReplaceRules(n){const e=n?.target?.files[0];if(!e)return;const s=new FileReader;s.onload=p=>{const l=p?.target?.result;if(!l)return;const y=this.exportImportService.importMorphologyReplaceRules(l);y&&(this.loader.start(),y.pipe((0,S.q)(1)).subscribe(()=>{this.loader.stop()}))},s.readAsText(e)}readMorphology(n){const e=n?.target?.files[0];if(!e)return;const s=new FileReader;s.onload=p=>{const l=p?.target?.result;if(!l)return;const y=this.exportImportService.importMorphology(l);y&&(this.loader.start(),y.pipe((0,S.q)(1)).subscribe(()=>{this.loader.stop()}))},s.readAsText(e)}readDictionary(n){const e=n?.target?.files[0];if(!e)return;const s=new FileReader;s.onload=p=>{const l=p?.target?.result;if(!l)return;const y=this.exportImportService.importDictionary(l);y&&(this.loader.start(),y.pipe((0,S.q)(1)).subscribe(()=>{this.loader.stop()}))},s.readAsText(e)}}return m.\u0275fac=function(n){return new(n||m)(t.Y36(o.D),t.Y36(h.U))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-import-dictionary"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:18,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["morphologyFileInput",""],["morphologyReplaceRulesFileInput",""],["dictionaryFileInput",""]],template:function(n,e){if(1&n){const s=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," It can take a few minutes to import a large dictionary. You'll have to wait. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){t.CHM(s);const l=t.MAs(13);return t.KtG(l.click())}),t._uU(5," Import (replace) morphology "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(s);const l=t.MAs(15);return t.KtG(l.click())}),t._uU(7," Import (replace) MorphologyReplaceRules "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){t.CHM(s);const l=t.MAs(17);return t.KtG(l.click())}),t._uU(9," Import (replace) dictionary "),t.qZA()(),t.TgZ(10,"div",0),t._uU(11," You have to reload web-application to apply new morphology and/or new dictionary. "),t.qZA()(),t.TgZ(12,"input",3,4),t.NdJ("change",function(l){return e.readMorphology(l)}),t.qZA(),t.TgZ(14,"input",3,5),t.NdJ("change",function(l){return e.readMorphologyReplaceRules(l)}),t.qZA(),t.TgZ(16,"input",3,6),t.NdJ("change",function(l){return e.readDictionary(l)}),t.qZA()}},dependencies:[r.ez,g.ot,g.lW,a.QW,a.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main);margin-top:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),m})();var x=i(8863),f=i(3631);let c=(()=>{class m{constructor(n,e){this.loader=n,this.favoriteExamplesService=e,this.update=new t.vpe,this.datePipe=new r.uU("en")}export(){const n=this.favoriteExamplesService.examples$.value;n?.length&&this.download(function u(m){return JSON.stringify(m,null,2)}({favoriteExamples:n}),"favorite-examples")}import(n){const e=n?.target?.files[0];if(!e)return;const s=new FileReader;s.onload=p=>{const l=p?.target?.result;if(!l)return;const y=this.favoriteExamplesService.import(l);y&&(this.loader.start(),y.pipe((0,S.q)(1)).subscribe(Z=>{this.loader.stop()}))},s.readAsText(e)}deleteAll(){window.confirm("Delete all?")&&(this.loader.start(),this.favoriteExamplesService.deleteAll().pipe((0,S.q)(1)).subscribe(e=>{this.loader.stop()}))}download(n,e){const s=this.datePipe.transform(new Date,"yyyy-MM-dd");(0,x.l)(n,e+`.${s}.json`)}}return m.\u0275fac=function(n){return new(n||m)(t.Y36(o.D),t.Y36(f.j))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-import-favorite-example"]],outputs:{update:"update"},standalone:!0,features:[t.jDz],decls:12,vars:0,consts:[[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"],["importFileInput",""]],template:function(n,e){if(1&n){const s=t.EpF();t.TgZ(0,"mat-card")(1,"div",0),t._uU(2," Favorite examples. You have to reload page after import. "),t.qZA(),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){return e.export()}),t._uU(5," Export Favorites "),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){t.CHM(s);const l=t.MAs(11);return t.KtG(l.click())}),t._uU(7," Import (add) Favorites "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return e.deleteAll()}),t._uU(9," Delete all Favorites "),t.qZA()()(),t.TgZ(10,"input",3,4),t.NdJ("change",function(l){return e.import(l)}),t.qZA()}},dependencies:[r.ez,g.ot,g.lW,a.QW,a.a8],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0}),m})();var v=i(9157),_=i(2032),C=i(6223),D=i(8805),A=i(2969);let M=(()=>{class m{constructor(n,e){this.customStylesService=n,this.localStorageService=e,this.copyToClipboardState=this.localStorageService.copyToClipboard,this.useExternalId=this.localStorageService.useExternalId,this.showDictionaryState=this.localStorageService.showDictionary,this.showTranslationState=this.localStorageService.showTranslationInBook,this.ankiHost=this.localStorageService.ankiHost,this.ankiDeck=this.localStorageService.ankiDeck}copyToClipboard(n){this.localStorageService.copyToClipboard=n,this.copyToClipboardState=n}toUseExternalId(n){this.localStorageService.useExternalId=n,this.useExternalId=n}showDictionary(n){this.localStorageService.showDictionary=n,this.showDictionaryState=n}setAnkiHost(){this.localStorageService.ankiHost=this.ankiHost}setAnkiDeck(){this.localStorageService.ankiDeck=this.ankiDeck}}return m.\u0275fac=function(n){return new(n||m)(t.Y36(D.N),t.Y36(A.n))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-settings"]],standalone:!0,features:[t.jDz],decls:41,vars:5,consts:[[1,"component-content"],[1,"header"],["mat-button","","color","primary","routerLink","/"],[1,"title"],[1,"settings"],[1,"divider"],[1,"setting-item"],["mat-button","","color","primary",3,"click"],[1,"text-area"],["matInput","",3,"ngModel","ngModelChange"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t._uU(3," Go Home. "),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"Settings"),t.qZA()(),t.TgZ(6,"div",4),t._UZ(7,"div",5),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return e.customStylesService.resetAllStyles()}),t._uU(10," Reset all styles "),t.qZA()(),t._UZ(11,"div",5),t.TgZ(12,"div",6)(13,"button",7),t.NdJ("click",function(){return e.copyToClipboard(!e.copyToClipboardState)}),t._uU(14),t.qZA()(),t._UZ(15,"div",5),t.TgZ(16,"div",6)(17,"mat-form-field",8)(18,"mat-label"),t._uU(19," ankiHost "),t.qZA(),t.TgZ(20,"input",9),t.NdJ("ngModelChange",function(p){return e.ankiHost=p}),t.qZA()(),t.TgZ(21,"button",7),t.NdJ("click",function(){return e.setAnkiHost()}),t._uU(22," setAnkiHost "),t.qZA()(),t.TgZ(23,"div",6)(24,"mat-form-field",8)(25,"mat-label"),t._uU(26," ankiDeck "),t.qZA(),t.TgZ(27,"input",9),t.NdJ("ngModelChange",function(p){return e.ankiDeck=p}),t.qZA()(),t.TgZ(28,"button",7),t.NdJ("click",function(){return e.setAnkiDeck()}),t._uU(29," setAnkiDeck "),t.qZA()(),t._UZ(30,"div",5),t.TgZ(31,"div",6)(32,"button",7),t.NdJ("click",function(){return e.toUseExternalId(!e.useExternalId)}),t._uU(33),t.qZA()(),t._UZ(34,"div",5),t.TgZ(35,"div",6)(36,"button",7),t.NdJ("click",function(){return e.showDictionary(!e.showDictionaryState)}),t._uU(37),t.qZA()(),t._UZ(38,"div",5)(39,"app-import-dictionary")(40,"app-import-favorite-example"),t.qZA()()),2&n&&(t.xp6(14),t.hij(" Copy to clipboard: ",e.copyToClipboardState," "),t.xp6(6),t.Q6J("ngModel",e.ankiHost),t.xp6(7),t.Q6J("ngModel",e.ankiDeck),t.xp6(6),t.hij(" Use ExternalId: ",e.useExternalId," "),t.xp6(4),t.hij(" Show dictionary: ",e.showDictionaryState," "))},dependencies:[r.ez,g.ot,g.lW,b.rH,d,c,v.lN,v.KE,v.hX,_.c,_.Nt,C.UX,C.Fj,C.JJ,C.u5,C.On],styles:[".component-content[_ngcontent-%COMP%]{padding:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.component-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%;min-width:100%;border-top:1px dashed gray;margin:var(--padding-main) 0}.component-content[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]{justify-content:center;display:flex;gap:8px;align-items:center}"]}),m})()},2969:(I,T,i)=>{i.d(T,{n:()=>t});var r=function(a){return a.CurrentPopupMenuTab="CurrentPopupMenuTab",a.CopyToClipboard="CopyToClipboard",a.UseExternalId="UseExternalId",a.ShowDictionary="ShowDictionary",a.HideMarkedHeaders="HideMarkedHeaders",a.ShowTranslationInBook="ShowTranslationInBook",a.AutoTranslateSelected="AutoTranslateSelected",a.ShowTranslatorInDictionaryViewer="ShowTranslatorInDictionaryViewer",a.AudioVoiceURI="AudioVoiceURI",a.AudioVolume="AudioVolume",a.AudioRate="AudioRate",a.AnkiDeck="AnkiDeck",a.AnkiHost="AnkiHost",a}(r||{}),g=i(2945),b=i(5879);let t=(()=>{class a{get ankiHost(){return localStorage.getItem(r.AnkiHost)||g.s7}set ankiHost(o){localStorage.setItem(r.AnkiHost,o||"")}get ankiDeck(){return localStorage.getItem(r.AnkiDeck)||""}set ankiDeck(o){localStorage.setItem(r.AnkiDeck,o||"")}get audioVoiceURI(){return localStorage.getItem(r.AudioVoiceURI)||""}set audioVoiceURI(o){localStorage.setItem(r.AudioVoiceURI,o||"")}get audioVolume(){return this.getNumber(r.AudioVolume,1)}set audioVolume(o){this.setNumber(r.AudioVolume,0===o?0:o||1)}get audioRate(){return this.getNumber(r.AudioRate,1)}set audioRate(o){this.setNumber(r.AudioRate,0===o?0:o||1)}get hideMarkedHeaders(){return this.getBoolean(r.HideMarkedHeaders,!1)}set hideMarkedHeaders(o){this.setBoolean(r.HideMarkedHeaders,o)}get copyToClipboard(){return this.getBoolean(r.CopyToClipboard,!1)}set copyToClipboard(o){this.setBoolean(r.CopyToClipboard,o)}get useExternalId(){return this.getBoolean(r.UseExternalId,!1)}set useExternalId(o){this.setBoolean(r.UseExternalId,o)}get showDictionary(){return this.getBoolean(r.ShowDictionary,!0)}set showDictionary(o){this.setBoolean(r.ShowDictionary,o)}get showTranslationInBook(){return this.getBoolean(r.ShowTranslationInBook,!0)}set showTranslationInBook(o){this.setBoolean(r.ShowTranslationInBook,o)}get currentPopupMenuTab(){return this.getNumber(r.CurrentPopupMenuTab)}set currentPopupMenuTab(o){this.setNumber(r.CurrentPopupMenuTab,o||0)}constructor(){this.trueString="true",this.falseString="false"}getString(o,h=""){return localStorage.getItem(o)||h}setString(o,h){localStorage.setItem(o,h)}setNumber(o,h){localStorage.setItem(o,String(h||0))}getNumber(o,h=0){const d=localStorage.getItem(o);if(null===d)return h;const x=+d;return Number.isNaN(x)?h:x}setBoolean(o,h){localStorage.setItem(o,h?this.trueString:this.falseString)}getBoolean(o,h=!1){const d=localStorage.getItem(o);return d===this.trueString||d!==this.falseString&&h}}return a.\u0275fac=function(o){return new(o||a)},a.\u0275prov=b.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()}}]);