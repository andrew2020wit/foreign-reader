"use strict";(self.webpackChunkforeign_reader=self.webpackChunkforeign_reader||[]).push([[722],{1177:(T,S,a)=>{a.d(S,{LH:()=>t,Ot:()=>y,Zt:()=>v,jk:()=>i});const i="http://127.0.0.1:8765",y=500,t="ankiTag",v="ankiRequestText"},7251:(T,S,a)=>{a.d(S,{f:()=>u});var i=a(4412),y=a(6697),t=a(7673),v=a(9040),s=a(4438),C=a(9456),e=a(9530);let u=(()=>{class m{constructor(g,h){this.dbService=g,this.infoService=h,this.examples$=new i.t([]),this.sort=(d,k)=>(d.toDoTimestamp||0)-(k.toDoTimestamp||0),this.dbService.getAll(v.Y.FavoriteExamples).pipe((0,y.s)(1)).subscribe(d=>{d.forEach(k=>k.showDetails=!1),d?(d.sort(this.sort),this.examples$.next(d)):this.examples$.next([])})}deleteAll(){return this.dbService.clear(v.Y.FavoriteExamples)}import(g){const h=JSON.parse(g)?.favoriteExamples;if(!h?.length)return console.error("!examples?.length"),this.infoService.error("!examples?.length"),(0,t.of)([]);const d=this.examples$.value.map(b=>b.timestamp);function k(b){return d.includes(b)?k(b+1):b}return h.forEach(b=>{if(!b.timestamp){const I=k(Date.now());d.push(I),b.timestamp=I}}),this.dbService.bulkAdd(v.Y.FavoriteExamples,h).pipe((0,y.s)(1))}addExample(g){const h=Date.now(),d={...g,timestamp:h,showDetails:!1};this.dbService.add(v.Y.FavoriteExamples,d).pipe((0,y.s)(1)).subscribe();const k=[d,...this.examples$.value];this.examples$.next(k),this.infoService.show("added: "+g.original)}update(g){if(!g?.timestamp||!g.toDoTimestamp)return;const h=this.examples$.value,d=h.find(k=>k.timestamp===g.timestamp);d&&(d.toDoTimestamp=g.toDoTimestamp,d.updateTimestamp=Date.now(),this.dbService.update(v.Y.FavoriteExamples,d).pipe((0,y.s)(1)).subscribe(),h.sort(this.sort),this.examples$.next(h))}removeExample(g){if(!g)return;this.dbService.delete(v.Y.FavoriteExamples,g).pipe((0,y.s)(1)).subscribe();const h=this.examples$.value.filter(d=>d.timestamp!==g);this.examples$.next(h)}static{this.\u0275fac=function(h){return new(h||m)(s.KVO(C.MX),s.KVO(e.O))}}static{this.\u0275prov=s.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}}return m})()},3722:(T,S,a)=>{a.r(S),a.d(S,{SettingsComponent:()=>_});var i=a(8834),y=a(4710),t=a(4438),v=a(5596),s=a(6697),C=a(7749),e=a(7118);let u=(()=>{class f{constructor(r,n){this.loader=r,this.exportImportService=n,this.update=new t.bkB}readMorphologyReplaceRules(r){const n=r?.target?.files[0];if(!n)return;const o=new FileReader;o.onload=c=>{const l=c?.target?.result;if(!l)return;const p=this.exportImportService.importMorphologyReplaceRules(l);p&&(this.loader.start(),p.pipe((0,s.s)(1)).subscribe(()=>{this.loader.stop()}))},o.readAsText(n)}readMorphology(r){const n=r?.target?.files[0];if(!n)return;const o=new FileReader;o.onload=c=>{const l=c?.target?.result;if(!l)return;const p=this.exportImportService.importMorphology(l);p&&(this.loader.start(),p.pipe((0,s.s)(1)).subscribe(()=>{this.loader.stop()}))},o.readAsText(n)}readDictionary(r){const n=r?.target?.files[0];if(!n)return;const o=new FileReader;o.onload=c=>{const l=c?.target?.result;if(!l)return;const p=this.exportImportService.importDictionary(l);p&&(this.loader.start(),p.pipe((0,s.s)(1)).subscribe(()=>{this.loader.stop()}))},o.readAsText(n)}static{this.\u0275fac=function(n){return new(n||f)(t.rXU(C.Z),t.rXU(e.p))}}static{this.\u0275cmp=t.VBU({type:f,selectors:[["app-import-dictionary"]],outputs:{update:"update"},standalone:!0,features:[t.aNF],decls:18,vars:0,consts:[["morphologyFileInput",""],["morphologyReplaceRulesFileInput",""],["dictionaryFileInput",""],[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"]],template:function(n,o){if(1&n){const c=t.RV6();t.j41(0,"mat-card")(1,"div",3),t.EFF(2," It can take a few minutes to import a large dictionary. You'll have to wait. "),t.k0s(),t.j41(3,"div",4)(4,"button",5),t.bIt("click",function(){t.eBV(c);const p=t.sdS(13);return t.Njj(p.click())}),t.EFF(5," Import (replace) morphology "),t.k0s(),t.j41(6,"button",5),t.bIt("click",function(){t.eBV(c);const p=t.sdS(15);return t.Njj(p.click())}),t.EFF(7," Import (replace) MorphologyReplaceRules "),t.k0s(),t.j41(8,"button",5),t.bIt("click",function(){t.eBV(c);const p=t.sdS(17);return t.Njj(p.click())}),t.EFF(9," Import (replace) dictionary "),t.k0s()(),t.j41(10,"div",3),t.EFF(11," You have to reload to apply the morphology and/or the dictionary. "),t.k0s()(),t.j41(12,"input",6,0),t.bIt("change",function(p){return t.eBV(c),t.Njj(o.readMorphology(p))}),t.k0s(),t.j41(14,"input",6,1),t.bIt("change",function(p){return t.eBV(c),t.Njj(o.readMorphologyReplaceRules(p))}),t.k0s(),t.j41(16,"input",6,2),t.bIt("change",function(p){return t.eBV(c),t.Njj(o.readDictionary(p))}),t.k0s()}},dependencies:[i.Hl,i.$z,v.Hu,v.RN],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main);margin-top:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0})}}return f})();var m=a(177),x=a(192),h=a(7251);let d=(()=>{class f{constructor(r,n){this.loader=r,this.favoriteExamplesService=n,this.update=new t.bkB,this.datePipe=new m.vh("en")}export(){const r=this.favoriteExamplesService.examples$.value;r?.length&&this.download(function g(f){return JSON.stringify(f,null,2)}({favoriteExamples:r}),"favorite-examples")}import(r){const n=r?.target?.files[0];if(!n)return;const o=new FileReader;o.onload=c=>{const l=c?.target?.result;if(!l)return;const p=this.favoriteExamplesService.import(l);p&&(this.loader.start(),p.pipe((0,s.s)(1)).subscribe(E=>{this.loader.stop()}))},o.readAsText(n)}deleteAll(){window.confirm("Delete all?")&&(this.loader.start(),this.favoriteExamplesService.deleteAll().pipe((0,s.s)(1)).subscribe(n=>{this.loader.stop()}))}download(r,n){const o=this.datePipe.transform(new Date,"yyyy-MM-dd");(0,x.V)(r,n+`.${o}.json`)}static{this.\u0275fac=function(n){return new(n||f)(t.rXU(C.Z),t.rXU(h.f))}}static{this.\u0275cmp=t.VBU({type:f,selectors:[["app-import-favorite-example"]],outputs:{update:"update"},standalone:!0,features:[t.aNF],decls:12,vars:0,consts:[["importFileInput",""],[1,"info"],[1,"create-import-block"],["mat-button","","color","primary",1,"link-item",3,"click"],["type","file","accept",".json",1,"hidden-file-input",3,"change"]],template:function(n,o){if(1&n){const c=t.RV6();t.j41(0,"mat-card")(1,"div",1),t.EFF(2," Favorite examples. You have to reload the page after import. "),t.k0s(),t.j41(3,"div",2)(4,"button",3),t.bIt("click",function(){return t.eBV(c),t.Njj(o.export())}),t.EFF(5," Export Favorites "),t.k0s(),t.j41(6,"button",3),t.bIt("click",function(){t.eBV(c);const p=t.sdS(11);return t.Njj(p.click())}),t.EFF(7," Import (add) Favorites "),t.k0s(),t.j41(8,"button",3),t.bIt("click",function(){return t.eBV(c),t.Njj(o.deleteAll())}),t.EFF(9," Delete all Favorites "),t.k0s()()(),t.j41(10,"input",4,0),t.bIt("change",function(p){return t.eBV(c),t.Njj(o.import(p))}),t.k0s()}},dependencies:[i.Hl,i.$z,v.Hu,v.RN],styles:[".create-import-block[_ngcontent-%COMP%]{padding:var(--padding-main)}.create-import-block[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;box-sizing:border-box}.hidden-file-input[_ngcontent-%COMP%]{display:none}.copyright[_ngcontent-%COMP%]{padding:var(--padding-main);width:100%;box-sizing:border-box;text-align:center;font-size:10px;color:gray}mat-card[_ngcontent-%COMP%]{margin-top:var(--padding-main)}.info[_ngcontent-%COMP%]{margin:auto;padding:var(--padding-small)}"],changeDetection:0})}}return f})();var k=a(882),b=a(9631),I=a(9417),D=a(5643),F=a(242);let _=(()=>{class f{constructor(r,n){this.customStylesService=r,this.localStorageService=n,this.copyToClipboardState=this.localStorageService.copyToClipboard,this.useExternalId=this.localStorageService.useExternalId,this.showDictionaryState=this.localStorageService.showDictionary,this.showTranslationState=this.localStorageService.showTranslationInBook,this.ankiHost=this.localStorageService.ankiHost,this.ankiDeck=this.localStorageService.ankiDeck}copyToClipboard(r){this.localStorageService.copyToClipboard=r,this.copyToClipboardState=r}toUseExternalId(r){this.localStorageService.useExternalId=r,this.useExternalId=r}showDictionary(r){this.localStorageService.showDictionary=r,this.showDictionaryState=r}setAnkiHost(){this.localStorageService.ankiHost=this.ankiHost}setAnkiDeck(){this.localStorageService.ankiDeck=this.ankiDeck}static{this.\u0275fac=function(n){return new(n||f)(t.rXU(D.V),t.rXU(F.s))}}static{this.\u0275cmp=t.VBU({type:f,selectors:[["app-settings"]],standalone:!0,features:[t.aNF],decls:41,vars:5,consts:[[1,"component-content"],[1,"header"],["mat-button","","color","primary","routerLink","/"],[1,"title"],[1,"settings"],[1,"divider"],[1,"setting-item"],["mat-button","","color","primary",3,"click"],[1,"text-area"],["matInput","",3,"ngModelChange","ngModel"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"button",2),t.EFF(3," Go Home. "),t.k0s(),t.j41(4,"div",3),t.EFF(5,"Settings"),t.k0s()(),t.j41(6,"div",4),t.nrm(7,"div",5),t.j41(8,"div",6)(9,"button",7),t.bIt("click",function(){return o.customStylesService.resetAllStyles()}),t.EFF(10," Reset all styles "),t.k0s()(),t.nrm(11,"div",5),t.j41(12,"div",6)(13,"button",7),t.bIt("click",function(){return o.copyToClipboard(!o.copyToClipboardState)}),t.EFF(14),t.k0s()(),t.nrm(15,"div",5),t.j41(16,"div",6)(17,"mat-form-field",8)(18,"mat-label"),t.EFF(19," ankiHost "),t.k0s(),t.j41(20,"input",9),t.mxI("ngModelChange",function(l){return t.DH7(o.ankiHost,l)||(o.ankiHost=l),l}),t.k0s()(),t.j41(21,"button",7),t.bIt("click",function(){return o.setAnkiHost()}),t.EFF(22," setAnkiHost "),t.k0s()(),t.j41(23,"div",6)(24,"mat-form-field",8)(25,"mat-label"),t.EFF(26," ankiDeck "),t.k0s(),t.j41(27,"input",9),t.mxI("ngModelChange",function(l){return t.DH7(o.ankiDeck,l)||(o.ankiDeck=l),l}),t.k0s()(),t.j41(28,"button",7),t.bIt("click",function(){return o.setAnkiDeck()}),t.EFF(29," setAnkiDeck "),t.k0s()(),t.nrm(30,"div",5),t.j41(31,"div",6)(32,"button",7),t.bIt("click",function(){return o.toUseExternalId(!o.useExternalId)}),t.EFF(33),t.k0s()(),t.nrm(34,"div",5),t.j41(35,"div",6)(36,"button",7),t.bIt("click",function(){return o.showDictionary(!o.showDictionaryState)}),t.EFF(37),t.k0s()(),t.nrm(38,"div",5)(39,"app-import-dictionary")(40,"app-import-favorite-example"),t.k0s()()),2&n&&(t.R7$(14),t.SpI(" Copy to clipboard: ",o.copyToClipboardState," "),t.R7$(6),t.R50("ngModel",o.ankiHost),t.R7$(7),t.R50("ngModel",o.ankiDeck),t.R7$(6),t.SpI(" Use ExternalId: ",o.useExternalId," "),t.R7$(4),t.SpI(" Show the dictionary: ",o.showDictionaryState," "))},dependencies:[i.Hl,i.$z,y.Wk,u,d,k.RG,k.rl,k.nJ,b.fS,b.fg,I.X1,I.me,I.BC,I.YN,I.vS],styles:[".component-content[_ngcontent-%COMP%]{padding:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-main)}.component-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.component-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%;min-width:100%;border-top:1px dashed gray;margin:var(--padding-main) 0}.component-content[_ngcontent-%COMP%]   .settings[_ngcontent-%COMP%]   .setting-item[_ngcontent-%COMP%]{justify-content:center;display:flex;gap:8px;align-items:center}"]})}}return f})()},242:(T,S,a)=>{a.d(S,{s:()=>v});var i=function(s){return s.CurrentPopupMenuTab="CurrentPopupMenuTab",s.CopyToClipboard="CopyToClipboard",s.UseExternalId="UseExternalId",s.ShowDictionary="ShowDictionary",s.HideMarkedHeaders="HideMarkedHeaders",s.ShowTranslationInBook="ShowTranslationInBook",s.AutoTranslateSelected="AutoTranslateSelected",s.ShowTranslatorInDictionaryViewer="ShowTranslatorInDictionaryViewer",s.AudioVoiceURI="AudioVoiceURI",s.AudioVolume="AudioVolume",s.AudioRate="AudioRate",s.AnkiDeck="AnkiDeck",s.AnkiHost="AnkiHost",s}(i||{}),y=a(1177),t=a(4438);let v=(()=>{class s{get ankiHost(){return localStorage.getItem(i.AnkiHost)||y.jk}set ankiHost(e){localStorage.setItem(i.AnkiHost,e||"")}get ankiDeck(){return localStorage.getItem(i.AnkiDeck)||""}set ankiDeck(e){localStorage.setItem(i.AnkiDeck,e||"")}get audioVoiceURI(){return localStorage.getItem(i.AudioVoiceURI)||""}set audioVoiceURI(e){localStorage.setItem(i.AudioVoiceURI,e||"")}get audioVolume(){return this.getNumber(i.AudioVolume,1)}set audioVolume(e){this.setNumber(i.AudioVolume,0===e?0:e||1)}get audioRate(){return this.getNumber(i.AudioRate,1)}set audioRate(e){this.setNumber(i.AudioRate,0===e?0:e||1)}get hideMarkedHeaders(){return this.getBoolean(i.HideMarkedHeaders,!1)}set hideMarkedHeaders(e){this.setBoolean(i.HideMarkedHeaders,e)}get copyToClipboard(){return this.getBoolean(i.CopyToClipboard,!1)}set copyToClipboard(e){this.setBoolean(i.CopyToClipboard,e)}get useExternalId(){return this.getBoolean(i.UseExternalId,!1)}set useExternalId(e){this.setBoolean(i.UseExternalId,e)}get showDictionary(){return this.getBoolean(i.ShowDictionary,!0)}set showDictionary(e){this.setBoolean(i.ShowDictionary,e)}get showTranslationInBook(){return this.getBoolean(i.ShowTranslationInBook,!0)}set showTranslationInBook(e){this.setBoolean(i.ShowTranslationInBook,e)}get currentPopupMenuTab(){return this.getNumber(i.CurrentPopupMenuTab)}set currentPopupMenuTab(e){this.setNumber(i.CurrentPopupMenuTab,e||0)}constructor(){this.trueString="true",this.falseString="false"}getString(e,u=""){return localStorage.getItem(e)||u}setString(e,u){localStorage.setItem(e,u)}setNumber(e,u){localStorage.setItem(e,String(u||0))}getNumber(e,u=0){const m=localStorage.getItem(e);if(null===m)return u;const x=+m;return Number.isNaN(x)?u:x}setBoolean(e,u){localStorage.setItem(e,u?this.trueString:this.falseString)}getBoolean(e,u=!1){const m=localStorage.getItem(e);return m===this.trueString||m!==this.falseString&&u}static{this.\u0275fac=function(u){return new(u||s)}}static{this.\u0275prov=t.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})()}}]);